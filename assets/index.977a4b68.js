var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,n=(e,n)=>{for(var s in n||(n={}))a.call(n,s)&&i(e,s,n[s]);if(t)for(var s of t(n))l.call(n,s)&&i(e,s,n[s]);return e};import{a as s,E as o,b as r,v as c,C as d,e as u,d as m,c as g,f as p,g as h,u as f,h as v,i as _,j as b,o as y,k as w,n as k,l as I,m as x,p as S,q as T,r as $,s as L,w as D,t as C,x as O,y as E,z as R,A as N,B as A,D as U,F as M,G as P,H as j,I as z,J as G,K as B,L as V,M as F,N as H,O as X,P as W,Q as q,R as J,S as K,T as Y,U as Q,V as Z,W as ee,X as te,Y as ae,Z as le,_ as ie,$ as ne,a0 as se,a1 as oe,a2 as re,a3 as ce,a4 as de,a5 as ue,a6 as me,a7 as ge,a8 as pe,a9 as he,aa as fe,ab as ve,ac as _e,ad as be,ae as ye,af as we,ag as ke,ah as Ie,ai as xe,aj as Se,ak as Te,al as $e,am as Le,an as De,ao as Ce,ap as Oe,aq as Ee,ar as Re,as as Ne,at as Ae,au as Ue,av as Me,aw as Pe,ax as je,ay as ze}from"./vendor.4a63d560.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const Ge=e=>{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null},Be="https://api.github.com",Ve=s.create({baseURL:Be,timeout:3e5});function Fe(e){const t={};e.method=e.method.toUpperCase();for(const a in e)"params"===a?"GET"===e.method?t.params=e.params:t.data=e.params:t[a]=e[a];return new Promise((e=>{Ve.request(t).then((t=>{const{status:a,data:l}=t;e(!t||200!==a&&201!==a&&204!==a?null:l||"SUCCESS")})).catch((a=>{var l;if((null==t?void 0:t.success422)&&422===(null==a?void 0:a.status))e((null==a?void 0:a.data)||"SUCCESS");else{const i=null==a?void 0:a.status,n=null==(l=null==a?void 0:a.data)?void 0:l.message;(null==t?void 0:t.noShowErrorMsg)||(console.error("PicX Error // ",a),void 0!==i&&void 0!==n&&o.error({duration:6e3,message:`Code: ${i}, Message: ${n}`})),e(null)}}))}))}Ve.defaults.headers["Content-Type"]="application/json",Ve.interceptors.request.use((e=>{var t;const a=Ge("PICX_CONFIG");if(a){const{token:l}=a;(null==(t=e.baseURL)?void 0:t.includes(Be))&&l&&(e.headers.Authorization=`token ${l}`)}return e}),(e=>Promise.reject(e))),Ve.interceptors.response.use((e=>e),(e=>((null==e?void 0:e.response)||o.error({duration:6e3,message:`${e}`}),Promise.reject(e.response))));const He=e=>Fe({url:"/user",method:"GET",headers:{Authorization:`token ${e}`}}),Xe=(e,t=1)=>new Promise((async a=>{const l=await Fe({url:`users/${e}/repos`,method:"GET",params:{type:"owner",sort:"created",direction:"desc",per_page:100,page:t}});l&&l.length?a(l.filter((e=>!e.fork&&!e.private)).map((e=>({value:e.name,label:e.name})))):a(null)})),We=async e=>{const t=[];for(let a=1;a<=3;a++){const l=await Xe(e,a);l&&t.push(...l)}return Promise.resolve(t.length?t:null)},qe=async(e,t=!0)=>{const{owner:a,selectedRepo:l,selectedBranch:i}=e;let n=null;t&&(n=r.service({text:"正在初始化仓库..."}));await Fe({url:`/repos/${a}/${l}/contents/README.md`,method:"PUT",data:{message:"init",branch:i,content:window.btoa("\n# Welcome to use PicX\n\n[PicX](https://github.com/XPoet/picx) is a simple and powerful image hosting tool. It supports image hosting services via GitHub repository.\n\nPicX is completely open source, and you can use it for free.\n\nIf you like it, please give it a star on [GitHub](https://github.com/XPoet/picx).\n        ")},noShowErrorMsg:!0})?null==n||n.close():t&&o.error("仓库初始化失败")},Je=(e,t)=>({type:"dir",dir:e,dirPath:t,childrenDirs:[],imageList:[]});function Ke(e,t,a){var l;return e?t.length===a?e:Ke(null==(l=e.childrenDirs)?void 0:l.find((e=>e.dir===t[a])),t,++a):null}const Ye=(e,t)=>{if("/"===e)return t;return Ke(t,e.split("/"),0)},Qe=(e,t,a)=>{var l;return"dir"===a?null==(l=t.childrenDirs)?void 0:l.filter((e=>"dir"===e.type)):"image"===a?t.imageList.filter((e=>"image"===e.type)):[]},Ze={state:{name:"dirImageListModule",dirObject:(()=>{const e=localStorage.getItem("PICX_MANAGEMENT");return e?JSON.parse(e):Je("/","/")})()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:t},a){if("/"===a)return;const l=(e,t,a)=>{if(e){e.childrenDirs.some((e=>e.dir===t))||e.childrenDirs.push(Je(t,a));return e.childrenDirs.find((e=>e.dir===t))||Je(t,a)}return Je(t,a)},i=a.split("/");let n="",s=e.dirObject;for(let o=0,r=i.length;o<r;o++){const e=i[o];n+=`${o>0?"/":""}${e}`,s=l(s,e,n),0===o&&t("USER_CONFIG_INFO_ADD_DIR",e)}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:t},a){if("/"===a)return;const l=a.split("/");let i=e.dirObject;l.forEach(((t,a)=>{i=((t,a,l)=>{if("/"===a)return e.dirObject;const i=t.childrenDirs.find((e=>e.dir===a));if(!i)return t;if(l){const e=t.childrenDirs.findIndex((e=>e.dir===a));-1!==e&&t.childrenDirs.splice(e,1)}return i})(i,t,a===l.length-1)})),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:t},a){let l=e.dirObject;if("/"===a.dir)l.imageList.some((e=>e.name===a.name))||l.imageList.push(a);else{const t=a.dir.split("/");let i="";t.forEach(((n,s)=>{i+=`${s>0?"/":""}${n}`,l=((t,a,l,i,n=!1)=>{var s;if(!t)return e.dirObject;let o=null==(s=t.childrenDirs)?void 0:s.find((e=>e.dir===a));return o||(o={type:"dir",dir:a,dirPath:l,childrenDirs:[],imageList:[]},t.childrenDirs.push(o)),n&&!o.imageList.some((e=>e.name===i.name))&&o.imageList.push(i),o})(l,n,i,a,s===t.length-1)}))}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:t},a){const l=(e,t)=>{if(e.length){const a=e.findIndex((e=>e.uuid===t));-1!==a&&e.splice(a,1)}},{dir:i,uuid:n}=a;if("/"===i)return l(e.dirObject.imageList,n),void t("DIR_IMAGE_LIST_PERSIST");const s=i.split("/");let o=e.dirObject;s.forEach(((i,n)=>{if(o=((t,a,i,n)=>{if(!t)return e.dirObject;const s=t.childrenDirs.find((e=>e.dir===a));return s?(s.dir===a&&n&&l(s.imageList,i.uuid),s):e.dirObject})(o,i,a,n===s.length-1),!o.imageList.length&&!o.childrenDirs.length){const a=(e=>{if("/"===e)return[];const t=e.split("/"),a=[];let l="";return t.forEach(((e,t)=>{l+=`${t>0?"/":""}${e}`,a.unshift(l)})),a})(o.dirPath);a.forEach((a=>{const l=Ye(a,e.dirObject);if(l&&!l.imageList.length&&!l.childrenDirs.length){const{dirPath:e}=(e=>{if("/"===e)return{currentDir:"/",dirPath:"/"};const t=e.split("/");return 1===t.length?{currentDir:"/",dirPath:"/"}:t.length>1?(t.length-=1,{currentDir:t[t.length-1],dirPath:t.join("/")}):{currentDir:"/",dirPath:"/"}})(a),l=e,i=e;let n=i.split("/");"/"===e&&(n=[],t("USER_CONFIG_INFO_REMOVE_DIR",a)),t("SET_USER_CONFIG_INFO",{viewDir:l,selectedDir:i,selectedDirList:n}),t("DIR_IMAGE_LIST_REMOVE_DIR",a)}}))}}))},DIR_IMAGE_LIST_INIT_DIR({state:e,dispatch:t},a){let l=e.dirObject;if("/"===a)return l.imageList=[],l.childrenDirs=[],void t("DIR_IMAGE_LIST_PERSIST");const i=a.split("/");i.forEach(((t,a)=>{l=((t,a,l)=>{var i;if(!t)return e.dirObject;const n=null==(i=t.childrenDirs)?void 0:i.find((e=>e.dir===a));return n?(l&&(n.imageList=[],n.childrenDirs=[]),n):e.dirObject})(l,t,a===i.length-1)})),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_PERSIST({state:e}){localStorage.setItem("PICX_MANAGEMENT",JSON.stringify(e.dirObject))},DIR_IMAGE_LOGOUT({state:e,dispatch:t}){e.dirObject=Je("/","/"),t("DIR_IMAGE_LIST_PERSIST")}},getters:{getDirObject:e=>e.dirObject}};var et,tt,at,lt,it,nt,st,ot,rt,ct,dt,ut,mt,gt,pt,ht,ft,vt,_t,bt,yt,wt;(tt=et||(et={})).uploaded="uploaded",tt.allUploaded="allUploaded",tt.uploadFail="uploadFail",(lt=at||(at={})).deleted="deleted",lt.allDeleted="allDeleted",lt.deleteFail="deleteFail",(nt=it||(it={})).mozJPEG="mozJPEG",nt.avif="avif",nt.webP="webP",(ot=st||(st={})).GitHub="GitHub",ot.GitHubPages="GitHub Pages",ot.jsDelivr="jsDelivr",ot.ChinaJsDelivr="ChinaJsDelivr",ot.Statically="Statically",ot.rawGitHub="rawGitHub",ot.ghProxy="ghProxy",ot.moeyy="moeyy",(ct=rt||(rt={})).newBranch="newBranch",ct.repoBranch="repoBranch",(ut=dt||(dt={})).autoDir="autoDir",ut.newDir="newDir",ut.rootDir="rootDir",ut.repoDir="repoDir",(gt=mt||(mt={})).large="large",gt.default="default",gt.small="small",(ht=pt||(pt={})).leftTop="leftTop",ht.leftBottom="leftBottom",ht.rightTop="rightTop",ht.rightBottom="rightBottom",(vt=ft||(ft={})).system="system",vt.light="light",vt.dark="dark",(bt=_t||(_t={})).zhCN="zh-CN",bt.zhTW="zh-TW",bt.en="en",(wt=yt||(yt={}))[wt.parentDir=0]="parentDir",wt[wt.childDir=1]="childDir",wt[wt.img=2]="img";var kt={repo:"仓库",branch:"分支",dir:"目录",tips:"提示",delete:"删除",reset:"重置",confirm:"确定",cancel:"取消",author:"作者",document:"文档",shortcut_key:"快捷键",copy_link:"复制图片链接",copy_success_1:"图片链接已自动复制到系统剪贴板",copy_success_2:"图片链接复制成功",copy_fail_1:"复制失败",header:{not_login:"未登录",login:"登录",logout:"退出登录",language:"语言",theme:"主题",usage_count:"使用次数"},nav:{config:"图床配置",upload:"上传图片",management:"图床管理",settings:"我的设置",toolbox:"工具箱",feedback:"帮助反馈",actions:"快捷操作"},actions:{watermark:"添加水印",compress:"压缩图片",transform:"转换 "},settings:{img_name:{title:"图片名称设置",hash_switch_name:"自动哈希化",hash_switch_desc:"上传前自动给图片名增加哈希码，确保图片名唯一，强烈建议开启",prefix_switch_name:"添加前缀命名",prefix_switch_desc:"上传前自动给图片名增加前缀，例如：abc-image.jpg，abc- 为前缀",prefix_input_placeholder:"请输入命名前缀 ...",timestamp_switch_name:"自动时间戳命名"},img_watermark:{title:"图片水印设置",switch_name:"是否添加水印",switch_desc:"开启后可以自定义水印文字、字体大小、位置、颜色和透明度",text:"水印文字",text_input_placeholder:"请输入水印文字，限制 20 字",size:"水印大小",color:"水印颜色",opacity:"水印透明度",position:"水印位置",position_1:"左上角",position_2:"左下角",position_3:"右上角",position_4:"右下角"},img_compress:{title:"图片压缩设置",switch_name:"是否压缩图片",switch_desc:"开启后上传前会自动压缩图片，有效缩短图片上传和加载时间，强烈建议开启",radio_group_title:"选择图片压缩算法",radio_1:"webP",radio_1_desc:"压缩后图片格式为 webp，压缩率较高，大多数浏览器支持",radio_2:"mozJPEG",radio_2_desc:"压缩后图片格式为 jpg，兼容性最好，所有浏览器支持",radio_3:"avif",radio_3_desc:"压缩后图片格式为 avif，压缩率极高，部分现代浏览器支持"},link_rule:{title:"图片链接规则配置",select_title:"选择图片链接规则",card_title:"配置自定义图片链接规则",card_table_col_title_1:"类型",card_table_col_title_2:"图片链接规则",card_table_col_title_3:"操作",input_name_1:"图片链接类型",input_name_1_rule:"图片链接类型名称不能为空",input_name_2:"图片链接规则",input_name_2_rule:"图片链接规则不能为空",btn_name_1:"添加图片链接规则",error_msg_1:"添加失败，该图片链接规则已存在",error_msg_2:"{action}失败，图片链接规则必须包含 {path}",error_msg_3:"图片链接规则缺少 {rules}，是否确认{action}？",add:"添加",edit:"编辑"},link_format:{title:"图片链接格式设置",switch_name:"自动转换图片链接格式",switch_desc:"上传成功后复制的图片链接自动转换成 {type} 格式",select_title:"选择图片链接格式",delete_tips:"此操作将永久删除图片链接规则"},image_hosting_deploy:{title:"图床部署",one_click_deploy:"一键部署",deploy_to:"部署到 {server}",success:"部署成功",fail:"部署失败",fail2:"部署失败，请稍后再试",deploying:"正在部署到 GitHub Pages，该过程持续 1 分钟左右，请耐心等待 ...",not_deployed:"未部署"},theme:{title:"主题设置",system:"跟随系统",dark:"暗夜",light:"白昼"},cloud_settings:{tip_1:"检测到你的设置数据未保存到云端仓库，是否保存？",tip_2:"检测到你的云端仓库有设置文件，是否使用？",tip_3:"检测到你的设置数据有变化，是否同步到云端仓库？",tip_4:"本地设置数据和云端仓库设置数据一致",success_msg_1:"保存成功",success_msg_2:"更新成功"}},config:{inputCommits:"请输入提交信息 ...",inputToken:"请输入 GitHub Token ...",manualConfiguration1:"手动配置",manualConfiguration2:"重新手动配置",manualConfiguration3:"使用已有的 GitHub 仓库，逐步完成配置",autoConfiguration1:"一键自动配置",autoConfiguration2:"重新一键自动配置",autoConfiguration3:"自动创建 GitHub 仓库（推荐）",username:"用户名",email:"邮箱",selectRepo:"选择仓库",selectBranch:"选择分支",loading1:"正在加载用户信息 ...",loading2:"正在加载分支信息 ...",loading3:"正在加载用户信息 ...",loading4:"正在加载{type}数据 ...",loading5:"正在加载目录信息 ...",loading6:"正在自动配置 ...",placeholder1:"请选择图床仓库 ...",placeholder2:"请选择分支 ...",placeholder3:"请输入新建的分支 ...",placeholder4:"请输入新建的目录 ...",placeholder5:"请选择一个目录 ...",message1:"GitHub Token 不能为空",message2:"用户信息获取失败，请确认 Token 是否正确",message3:"自动创建 GitHub 仓库失败，请稍后再试",message4:"自动配置成功",message5:"一键自动配置失败，请重试",message6:"目录不能为空",message7:"请输入一个新目录",message8:"请选择 {repo} 仓库里的一个目录",message9:"仓库信息获取失败，请稍后重试",message11:"用户信息获取失败，请确认 GitHub Token 是否有效",selectBranch2:"选择 {repo}} 仓库里的分支",reload:"重新载入所有{type}数据",dirMode:"目录模式",inputNewDir:"手动输入一个新目录",createNewDir:"新建目录",rootDir:"根目录",rootDir2:"图片存储在 {branch} 分支的根目录下",autoDir:"自动目录",autoDir2:"根据日期自动创建格式 yyyyMMdd 的目录",repoDir:"选择 {repo} 仓库目录",repoDir2:"选择 {branch} 分支里的一个目录",selectDir:"选择目录"},upload:{uploadAreaTips:"拖拽 / 粘贴 / 点击此处选择图片",uploaded:"已上传",upload:"上传",message1:"请先完成图床配置",message2:"请选择一个仓库",message3:"目录不能为空",message4:"请选择要上传的图片",message5:"图片上传成功",message6:"图片批量上传成功",message7:"上传失败，请稍后重试",message8:"图片上传成功",fold:"折叠",expand:"展开",hash:"哈希化",rename:"重命名","timestamp-naming":"时间戳命名",prefixNaming:"前缀命名",delete:"删除",copyLink:"复制图片链接",loading1:"正在上传 ..."},management:{reload:"重新加载 {dir} 目录所有数据",loadingTxt1:"加载中 ...",loadingTxt2:"正在重命名 ...",loadingTxt3:"删除中 ...",back:"双击后退",toNextDir:"双击进入下一级目录",property:"属性",delTips:"此操作将会永久删除图片",delTips2:"已选中 {total} 张图片，是否批量删除？",renameTips:"该图片重命名为 {name} ？",message1:"图片名不能为空",message2:"图片名无改变",message3:"重命名失败",message4:"更新成功",message5:"删除成功",message6:"批量删除成功",message7:"删除失败，请稍后重试",imageName:"图片名称",imageSize:"图片大小",selectAll:"全选",deselectAll:"取消全选",unselect:"取消选择",batchCopy:"批量复制图片链接",batchDelete:"批量删除图片",selectTotal:"已选择 {total} 张图片",contextmenu_1:"从当前位置上传新图片",contextmenu_2:"上传图片到 < {dir} >",contextmenu_3:"根目录"},toolbox:{tool_1:"图片压缩",tool_1_desc:"不限制图片大小和数量，不上传至服务器的离线极致压缩",tool_2:"图片转 Base64",tool_2_desc:"不限制图片大小和数量，在线转换成 Base64 编码",tool_3:"图片水印 ",tool_3_desc:"自定义水印文字、字体大小、位置、颜色和透明度",copy_base64:"点击复制 Base64 编码",copy_base64_success:"Base64 编码复制成功",click_download:"点击下载",compress:"压缩",batch_download:"批量下载",add_watermark:"添加水印"},feedback:{text_1:"PicX 是一款基于 GitHub API 开发的图床工具，提供图片上传托管、生成图片链接和常用图片工具箱服务。",text_2:"建议将本站添加到浏览器收藏夹，方便下次使用。",text_3:"如果 PicX 对你有帮助，欢迎赞赏作者，支持开源。",text_4:"郑重声明：请勿使用 PicX 上传违反你当地法律的图片，所造成的一切后果与作者无关。"},region:{CN:"中国大陆",HK:"中国香港",MO:"中国澳门",TW:"中国台湾",SG:"新加坡",JP:"日本",US:"美国",NL:"荷兰"},language:{"zh-CN":"中文简体","zh-TW":"中文繁体",en:"英文"},toggle_language_msg:"检测到你的 IP 所属地为{region}，是否切换{language}？"};var It={repo:"倉庫",branch:"分支",dir:"目錄",tips:"提示",delete:"刪除",reset:"重置",confirm:"確定",cancel:"取消",author:"作者",document:"文檔",shortcut_key:"快捷鍵",copy_link:"復製圖片鏈接",copy_success_1:"圖片鏈接已自動復製到系統剪貼板",copy_success_2:"圖片鏈接復製成功",copy_fail_1:"復製失敗",header:{not_login:"未登錄",login:"登錄",logout:"退出登錄",language:"語言",theme:"主題",usage_count:"使用次數"},nav:{config:"圖床配置",upload:"上傳圖片",management:"圖床管理",settings:"我的設置",toolbox:"工具箱",feedback:"幫助反饋",actions:"快捷操作"},actions:{watermark:"添加水印",compress:"壓縮圖片",transform:"轉換 "},settings:{img_name:{title:"圖片名稱設置",hash_switch_name:"自動哈希化",hash_switch_desc:"上傳前自動給圖片名增加哈希碼，確保圖片名唯一，強烈建議開啟",prefix_switch_name:"添加前綴命名",prefix_switch_desc:"上傳前自動給圖片名增加前綴，例如：abc-image.jpg，abc- 為前綴",prefix_input_placeholder:"請輸入命名前綴 ...",timestamp_switch_name:"自動時間戳命名"},img_watermark:{title:"圖片水印設置",switch_name:"是否添加水印",switch_desc:"開啟後可以自定義水印文字、字體大小、位置、顏色和透明度",text:"水印文字",text_input_placeholder:"請輸入水印文字，限製 20 字",size:"水印大小",color:"水印顏色",opacity:"水印透明度",position:"水印位置",position_1:"左上角",position_2:"左下角",position_3:"右上角",position_4:"右下角"},img_compress:{title:"圖片壓縮設置",switch_name:"是否壓縮圖片",switch_desc:"開啟後上傳前會自動壓縮圖片，有效縮短圖片上傳和加載時間，強烈建議開啟",radio_group_title:"選擇圖片壓縮算法",radio_1:"webP",radio_1_desc:"壓縮後圖片格式為 webp，壓縮率較高，大多數瀏覽器支持",radio_2:"mozJPEG",radio_2_desc:"壓縮後圖片格式為 jpg，兼容性最好，所有瀏覽器支持",radio_3:"avif",radio_3_desc:"壓縮後圖片格式為 avif，壓縮率極高，部分現代瀏覽器支持"},link_rule:{title:"圖片鏈接規則配置",select_title:"選擇圖片鏈接規則",card_title:"配置自定義圖片鏈接規則",card_table_col_title_1:"類型",card_table_col_title_2:"圖片鏈接規則",card_table_col_title_3:"操作",input_name_1:"圖片鏈接類型",input_name_1_rule:"圖片鏈接類型名稱不能為空",input_name_2:"圖片鏈接規則",input_name_2_rule:"圖片鏈接規則不能為空",btn_name_1:"新增圖片鏈接規則",error_msg_1:"新增失敗，該圖片連結規則已存在",error_msg_2:"{action}失敗，圖片連結規則必須包含 {path}",error_msg_3:"圖片連結規則缺少 {rules}，是否確認{action}？",add:"新增",edit:"編輯"},link_format:{title:"圖片鏈接格式設置",switch_name:"自動轉換圖片鏈接格式",switch_desc:"上傳成功後復製的圖片鏈接自動轉換成 {type} 格式",select_title:"選擇圖片鏈接格式",delete_tips:"此操作將永久刪除圖片鏈接規則"},image_hosting_deploy:{title:"圖床部署",one_click_deploy:"一鍵部署",deploy_to:"部署到 {server}",success:"部署成功",fail:"部署失敗",fail2:"部署失敗，請稍後再試",deploying:"正在部署到 GitHub Pages，該過程持續 1 分鐘左右，請耐心等待 ...",not_deployed:"未部署"},theme:{title:"主題設置",system:"跟隨系統",dark:"暗夜",light:"白晝"},cloud_settings:{tip_1:"偵測到你的設定資料未儲存到雲端倉庫，是否儲存？",tip_2:"偵測到你的雲端倉庫有設定文件，是否使用？",tip_3:"偵測到你的設定資料有變化，是否同步到雲端倉庫？",tip_4:"本地設定資料與雲端倉庫設定資料一致",success_msg_1:"儲存成功",success_msg_2:"更新成功"}},config:{inputCommits:"請輸入提交資訊 ...",inputToken:"請輸入 GitHub Token ...",manualConfiguration1:"手動配置",manualConfiguration2:"重新手動配置",manualConfiguration3:"使用已有的 GitHub 倉庫，逐步完成配置",autoConfiguration1:"一鍵自動配置",autoConfiguration2:"重新一鍵自動配置",autoConfiguration3:"自動創建 GitHub 倉庫（推薦）",username:"用戶名",email:"郵箱",selectRepo:"選擇倉庫",selectBranch:"選擇分支",loading1:"正在加載用戶信息 ...",loading2:"正在加載分支信息 ...",loading3:"正在加載用戶信息 ...",loading4:"正在加載{type}數據 ...",loading5:"正在加載目錄信息 ...",loading6:"正在自動配置 ...",placeholder1:"請選擇圖床倉庫 ...",placeholder2:"請選擇分支 ...",placeholder3:"請輸入新建的分支 ...",placeholder4:"請輸入新建的目錄 ...",placeholder5:"請選擇一個目錄 ...",message1:"GitHub Token 不能為空",message2:"用戶信息獲取失敗，請確認 Token 是否正確",message3:"自動創建 GitHub 倉庫失敗，請稍後再試",message4:"自動配置成功",message5:"一鍵自動配置失敗，請重試",message6:"目錄不能為空",message7:"請輸入一個新目錄",message8:"請選擇 {repo} 倉庫裏的一個目錄",message9:"倉庫信息獲取失敗，請稍後重試",message11:"用戶信息獲取失敗，請確認 GitHub Token 是否有效",selectBranch2:"選擇 {repo}} 倉庫裏的分支",reload:"重新載入所有{type}數據",dirMode:"目錄模式",inputNewDir:"手動輸入一個新目錄",createNewDir:"新建目錄",rootDir:"根目錄",rootDir2:"圖片存儲在 {branch} 分支的根目錄下",autoDir:"自動目錄",autoDir2:"根據日期自動創建格式 yyyyMMdd 的目錄",repoDir:"選擇 {repo} 倉庫目錄",repoDir2:"選擇 {branch} 分支裏的一個目錄",selectDir:"選擇目錄"},upload:{uploadAreaTips:"拖拽 / 粘貼 / 點擊此處選擇圖片",uploaded:"已上傳",upload:"上傳",message1:"請先完成圖床配置",message2:"請選擇一個倉庫",message3:"目錄不能為空",message4:"請選擇要上傳的圖片",message5:"圖片上傳成功",message6:"圖片批量上傳成功",message7:"上傳失敗，請稍後重試",message8:"圖片上傳成功",fold:"折疊",expand:"展開",hash:"哈希化",rename:"重命名","timestamp-naming":"時間戳命名",prefixNaming:"前綴命名",delete:"刪除",copyLink:"復製圖片鏈接",loading1:"正在上傳 ..."},management:{reload:"重新加載 {dir} 目錄所有數據",loadingTxt1:"加載中 ...",loadingTxt2:"正在重命名 ...",loadingTxt3:"刪除中 ...",back:"雙擊後退",toNextDir:"雙擊進入下一級目錄",property:"屬性",delTips:"此操作將會永久刪除圖片",delTips2:"已選中 {total} 張圖片，是否批量刪除？",renameTips:"該圖片重命名為 {name} ？",message1:"圖片名不能為空",message2:"圖片名無改變",message3:"重命名失敗",message4:"更新成功",message5:"刪除成功",message6:"批量刪除成功",message7:"刪除失敗，請稍後重試",imageName:"圖片名稱",imageSize:"圖片大小",selectAll:"全選",deselectAll:"取消全選",unselect:"取消選擇",batchCopy:"批量復製圖片鏈接",batchDelete:"批量刪除圖片",selectTotal:"已選擇 {total} 張圖片",contextmenu_1:"從當前位置上傳新圖片",contextmenu_2:"上傳圖片到 < {dir} >",contextmenu_3:"根目錄"},toolbox:{tool_1:"圖片壓縮",tool_1_desc:"不限製圖片大小和數量，不上傳至服務器的離線極致壓縮",tool_2:"圖片轉 Base64",tool_2_desc:"不限製圖片大小和數量，在線轉換成 Base64 編碼",tool_3:"圖片水印 ",tool_3_desc:"自定義水印文字、字體大小、位置、顏色和透明度",copy_base64:"點擊復製 Base64 編碼",copy_base64_success:"Base64 編碼復製成功",click_download:"點擊下載",compress:"壓縮",batch_download:"批量下載",add_watermark:"添加水印"},feedback:{text_1:"PicX 是一款基於 GitHub API 開發的圖床工具，提供圖片上傳托管、生成圖片鏈接和常用圖片工具箱服務。",text_2:"建議將本站添加到瀏覽器收藏夾，方便下次使用。",text_3:"如果 PicX 對你有幫助，歡迎贊賞作者，支持開源。",text_4:"鄭重聲明：請勿使用 PicX 上傳違反你當地法律的圖片，所造成的一切後果與作者無關。"},region:{CN:"中國大陸",HK:"中國香港",MO:"中国澳门",TW:"中國臺灣",SG:"新加坡",JP:"日本",US:"美國",NL:"荷蘭"},language:{"zh-CN":"中文簡體","zh-TW":"中文繁體",en:"英文"},toggle_language_msg:"檢測到你的 IP 所屬地為{region}，是否切換{language}？"};var xt={repo:"Repository",branch:"Branch",dir:"Directory",tips:"Tips",delete:"Delete",reset:"Reset",confirm:"Confirm",cancel:"Cancel",author:"Author",document:"Document",shortcut_key:"Shortcut key",copy_link:"Copy image link",copy_success_1:"The image link has been automatically copied to the system clipboard",copy_success_2:"Image link copied successfully",copy_fail_1:"Copy failed",header:{not_login:"Not log in",login:"Log in",logout:"Log out",language:"Language",theme:"Theme",usage_count:"Usage count"},nav:{config:"Image Hosting Config",upload:"Upload Image",management:"Image Hosting Management",settings:"My Settings",toolbox:"Toolbox",feedback:"Feedback",actions:"Quick actions"},actions:{compress:"Compress Image",watermark:"Add Watermark",transform:"Transform "},settings:{img_name:{title:"Image Name Settings",hash_switch_name:"Hashing",hash_switch_desc:"Automatically add a hash code to the image name before uploading to ensure uniqueness. It is strongly recommended to turn on this feature.",prefix_switch_name:"Add Prefix",prefix_switch_desc:"Automatically add a prefix to the image name before uploading. For example: abc-image.jpg, where abc- is the prefix.",prefix_input_placeholder:"Please enter the name prefix...",timestamp_switch_name:"Automatically timestamp naming"},img_watermark:{title:"Image Watermark Settings",switch_name:"Add Watermark",switch_desc:"After turning on this feature, you can customize the watermark text, font size, position, color, and transparency.",text:"Text",text_input_placeholder:"Please enter the watermark text, limited to 20 characters.",size:"Size",color:"Color",opacity:"Opacity",position:"Position",position_1:"Top Left",position_2:"Bottom Left",position_3:"Top Right",position_4:"Bottom Right"},img_compress:{title:"Image Compression Settings",switch_name:"Compress Images",switch_desc:"After enable, the image will be auto compressed before uploading, which can effectively shorten the image upload and loading time. It is strongly recommended enable.",radio_group_title:"Select image compression algorithm",radio_1:"WebP",radio_1_desc:"The compressed image format is webp, which has a higher compression ratio and is supported by most browsers.",radio_2:"MozJPEG",radio_2_desc:"The compressed image format is jpg, which has the best compatibility and is supported by all browsers.",radio_3:"AVIF",radio_3_desc:"The compressed image format is avif, which has an extremely high compression ratio and is supported by some modern browsers."},link_rule:{title:"Image Link Rules Configuration",select_title:"Select Image Link Rule",card_title:"Configure Custom Image Link Rules",card_table_col_title_1:"Type",card_table_col_title_2:"Image Link Rule",card_table_col_title_3:"Action",input_name_1:"Link Type",input_name_1_rule:"The Image Link Type Name cannot be empty.",input_name_2:"Link Rule",input_name_2_rule:"The Image Link Rule cannot be empty.",btn_name_1:"Add Image Link Rule",error_msg_1:"Failed to add, the image link rule already exists",error_msg_2:"{action} failed, image link rule must contain {path}",error_msg_3:"The image link rule is missing {rules}. Do you want to confirm {action}?",add:"add",edit:"edit"},link_format:{title:"Image Link Format Settings",switch_name:"Automatically Convert Image Link Format",switch_desc:"After a successful upload, the copied image link will be automatically converted to the {type} format.",select_title:"Select Image Link Format",delete_tips:"This operation will permanently delete the image link rule"},image_hosting_deploy:{title:"Image hosting deployment",one_click_deploy:"One-click deployment",deploy_to:"Deploy to {server}",success:"Deployment successful",fail:"Deployment failed",fail2:"Deployment failed, please try again later",deploying:"Deploying to GitHub Pages, this process will take about 1 minute, please wait patiently...",not_deployed:"Not deployed"},theme:{title:"Theme Settings",system:"System",dark:"Dark",light:"Light"},cloud_settings:{tip_1:"It is detected that your settings data is not saved to the cloud repository. Do you want to save it?",tip_2:"It is detected that your cloud repository has a configuration file. Do you want to use it?",tip_3:"It is detected that your settings data has changed. Do you want to synchronize it to the cloud repository?",tip_4:"The local settings data is consistent with the cloud repository settings data",success_msg_1:"Save successfully",success_msg_2:"Update successful"}},config:{inputCommits:"Please input commits ...",inputToken:"Please input GitHub Token ...",manualConfiguration1:"Manual Configuration",manualConfiguration2:"Reconfigure Manually",manualConfiguration3:"Configure using an existing GitHub repository step by step",autoConfiguration1:"One-click Automatic Configuration",autoConfiguration2:"Reconfigure Automatically",autoConfiguration3:"Automatically create a GitHub repository (Recommend)",username:"Username",email:"Email",selectRepo:"Select Repo",selectBranch:"Select Branch",loading1:"Loading user information ...",loading2:"Loading branch information ...",loading3:"Loading user information ...",loading4:"Loading {type} data ...",loading5:"Loading directory information ...",loading6:"Automatically configuring ...",placeholder1:"Please select image hosting repository ...",placeholder2:"Please select branch ...",placeholder3:"Please enter the name of new branch ...",placeholder4:"Please enter the newly created directory ...",placeholder5:"Please select a directory ...",message1:"GitHub token cannot be empty",message2:"Failed to retrieve user information, please verify that the token is correct",message3:"Failed to automatically create GitHub repository, please try again later",message4:"Automated configuration successful",message5:"One-click automated configuration failed, please try again.",message6:"Directory cannot be empty",message7:"Please enter a new directory",message8:"Please select a directory in the {repo} repository",message9:"Failed to retrieve repository information, please try again later",message11:"Failed to retrieve user information, please verify that the GitHub Token is valid",reload:"Reload all {type} data",dirMode:"Dir Mode",inputNewDir:"Manually input a new directory",createNewDir:"New Dir",rootDir:"Root Dir",rootDir2:"Images are stored in the root directory of {branch} branch",autoDir:"Auto Dir",autoDir2:"Automatically create a directory with format yyyyMMdd",repoDir:"Select directory in {repo} repository",repoDir2:"Choose a directory in the {branch} branch",selectDir:"Select Dir"},upload:{uploadAreaTips:"Drag / Paste / Click here to select images",uploaded:"Uploaded",upload:"Upload",message1:"Please complete the image hosting configuration first",message2:"Please select a repository",message3:"Directory cannot be empty",message4:"Please select an image to upload",message5:"Image uploaded successfully",message6:"Images uploaded successfully in batch",message7:"Upload failed, please try again later",message8:"Image uploaded successfully",fold:"Fold",expand:"Expand",hash:"Hashing",rename:"Rename","timestamp-naming":"Timestamp Naming",prefixNaming:"Prefix Naming",delete:"Delete",copyLink:"Copy image link",loading1:"Uploading ..."},management:{reload:"Reload all data in the {dir} directory",loadingTxt1:"Loading ...",loadingTxt2:"Renaming ...",loadingTxt3:"Deleting ...",back:"Double-click back",toNextDir:"Double-click to enter the next level directory",property:"Property",delTips:"This operation will permanently delete the image",delTips2:"Are you sure you want to delete the selected {total} images in bulk?",renameTips:"Rename this picture to {name}?",message1:"Image name cannot be empty",message2:"Image name unchanged",message3:"Rename failed",message4:"Update successfully",message5:"Delete successfully",message6:"Batch delete successfully",message7:"Deletion failed, please try again later",imageName:"Image name",imageSize:"Image size",selectAll:"Select all",deselectAll:"Deselect all",unselect:"Unselect",batchCopy:"Batch copy image link",batchDelete:"Batch delete image",selectTotal:"Selected {total} images",contextmenu_1:"Upload new image from current location",contextmenu_2:"Upload image to < {dir} >",contextmenu_3:"Root directory"},toolbox:{tool_1:"Image Compressor",tool_1_desc:"Offline ultimate compression without size or quantity limit, and without uploading to server",tool_2:"Image to Base64",tool_2_desc:"Online conversion of images to Base64 encoding without size or quantity limit",tool_3:"Image Watermark",tool_3_desc:"Customize watermark text, font size, position, color and opacity",copy_base64:"Click to copy Base64 encoding",copy_base64_success:"Base64 encoding copied successfully",click_download:"Click to download",compress:"Compress",batch_download:"Batch Download",add_watermark:"Add Watermark"},feedback:{text_1:"PicX is a GitHub API based image hosting tool, providing image upload and hosting, generating image links, and a set of commonly used image tools.",text_2:"We suggest adding our website to your browser bookmarks for easy future access.",text_3:"If PicX is helpful to you, please consider donating to the author to support open source development.",text_4:"Disclaimer: Do not upload images that violate the laws in your local jurisdiction. The author is not responsible for any consequences arising from such actions."},region:{CN:"Mainland China",HK:"Hong Kong, China",MO:"Macao, China",TW:"Taiwan, China",SG:"Singapore",JP:"Japan",US:"United States",NL:"Netherlands"},language:{"zh-CN":"Simplified Chinese","zh-TW":"Traditional Chinese",en:"English"},toggle_language_msg:"We detected that your IP is located in {region}. Do you want to switch to {language}?"};const St=c.createI18n({locale:"zh-CN",messages:{"zh-CN":kt,"zh-TW":It,en:xt}}),Tt=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},$t=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),Lt=(e,t)=>{navigator.clipboard.writeText(e).then((()=>{t&&t()}))},Dt=e=>{for(const t in e)switch(Tt(e[t])){case"object":Dt(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1}},Ct=(e,t)=>{for(const a in t)"object"!==Tt(t[a])?e&&(e[a]=t[a]):e[a]&&Ct(e[a],t[a])},Ot=(e="yyyy-MM-dd hh:mm:ss",t=Date.now())=>{function a(e){return`00${e}`.substr(e.length)}const l=new Date(t);/(y+)/.test(e)&&(e=e.replace(RegExp.$1,`${l.getFullYear()}`.substr(4-RegExp.$1.length)));const i={"M+":l.getMonth()+1,"d+":l.getDate(),"h+":l.getHours(),"m+":l.getMinutes(),"s+":l.getSeconds()};for(const n in i)if(new RegExp(`(${n})`).test(e)){const t=`${i[n]}`;e=e.replace(RegExp.$1,1===RegExp.$1.length?t:a(t))}return e},Et=e=>{e&&(window.document.title=`${St.global.t(e)} | PicX`)},Rt=(e,t)=>{function a(e){const t={};for(const[l,i]of Object.entries(e))if("object"==typeof i&&null!==i){const e=a(i);for(const[a,i]of Object.entries(e))t[`${l}.${a}`]=i}else t[l]=i;return t}return Object.entries(a(e)).toString()===Object.entries(a(t)).toString()};async function Nt(e,t){const{text:a,fontSize:l,position:i,textColor:n,opacity:s}=t,[o,r,c]=(d=n,d?(d=d.replace("#",""),`${parseInt(d.substring(0,2),16)}, ${parseInt(d.substring(2,4),16)}, ${parseInt(d.substring(4,6),16)}`):"255,255,255").split(",");var d;const u=await function(e){return new Promise(((t,a)=>{const l=new FileReader;l.onload=()=>{const e=new Image;e.setAttribute("crossOrigin","Anonymous"),e.onload=()=>t(e),e.onerror=a,e.src=l.result},l.onerror=a,l.readAsDataURL(e)}))}(e),m=document.createElement("canvas"),g=m.getContext("2d");m.width=u.width,m.height=u.height,g.drawImage(u,0,0),g.font=`bold ${l}px Arial`,g.strokeStyle=`rgba(0, 0, 0, ${s})`,g.lineWidth=3,g.fillStyle=`rgba(${o}, ${r}, ${c}, ${s})`;let p=0,h=0;switch(i){case pt.leftTop:p=10,h=l+5;break;case pt.rightTop:p=m.width-g.measureText(a).width-10,h=l+5;break;case pt.leftBottom:p=10,h=m.height-15;break;case pt.rightBottom:p=m.width-g.measureText(a).width-10,h=m.height-15}return g.strokeText(a,p,h),g.fillText(a,p,h),new Promise((t=>{m.toBlob((a=>{if(a){const l=new File([a],e.name,{type:e.type});t(l)}else t(null)}),e.type)}))}const At=(e,t=!1)=>{e.forEach((e=>{e.deleting=t}))};async function Ut(e,t){if(1===e.length)return await async function(e,t){e.deleting=!0;const{owner:a,selectedRepo:l}=t,{path:i,sha:n}=e;return new Promise((async t=>{const s=await pa(a,l,i,n);e.deleting=!1,s?(t(!0),await oa.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),await oa.dispatch("DIR_IMAGE_LIST_REMOVE",e)):t(!1)}))}(e[0],t)?at.deleted:at.deleteFail;try{return await async function(e,t){At(e,!0);const{owner:a,selectedRepo:l,selectedBranch:i}=t,n=await ma(a,l,i);if(!n)throw At(e,!1),new Error("获取分支信息失败");const s=await fa(a,l,e.map((e=>({path:e.path,sha:null}))),n);if(!s)throw At(e,!1),new Error("创建 tree 失败");const o=await va(a,l,s,n);if(!o)throw At(e,!1),new Error("创建 commit 失败");if(!(await _a(a,l,i,o.sha)))throw At(e,!1),new Error("更新 ref 失败");e.forEach((e=>{e.deleting=!1,oa.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),oa.dispatch("DIR_IMAGE_LIST_REMOVE",e)}))}(e,t),at.allDeleted}catch(a){return console.error(a),at.deleteFail}}function Mt(e){return new Promise((t=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>{const e=a.result;t(e)},a.onerror=()=>t(null)}))}function Pt(e){const t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=e.name,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)}const jt=e=>{const t=e.indexOf(".");return e.substr(0,t).trim().replace(/\s+/g,"-")},zt=e=>{const t=e.lastIndexOf(".");return e.slice(t+1)},Gt=e=>/(png|jpg|jpeg|gif|webp|awebp|avif|svg\+xml|svg|x-icon|vnd.microsoft.icon)$/.test(e),Bt=e=>e?Number((e/1024).toFixed(0)):e,Vt=e=>new Promise((async t=>{e||t(null),Gt(e.type)||(o.error(`${e.name} 不是图片格式`),t(null));const a=await Mt(e)||"";Bt(a.length)>=30720&&(o.error(`${e.name} 超过 30 MB，跳过选择`),t(null)),t({uuid:$t(),base64:a,file:e})})),Ft=async(e,t)=>{if(a=e.type,/(png|jpg|jpeg|webp|avif)$/.test(a)){return new d(e,{encoderState:{type:t,options:u[t].meta.defaultOptions},processorState:m,preprocessorState:g}).process()}var a;return e},Ht=(e,t,a)=>{const{selected:l}=a.imageLinkType,{rule:i}=a.imageLinkType.presetList[l];if(i){const{owner:a,selectedRepo:l,selectedBranch:n}=t;return i.replaceAll("{{owner}}",a).replaceAll("{{repo}}",l).replaceAll("{{branch}}",n).replaceAll("{{path}}",e.path)}return null},Xt=(e,t,a)=>{var l;if(a.imageLinkFormat.enable){const i=a.imageLinkFormat.selected,n=null==(l=a.imageLinkFormat.presetList.find((e=>e.name===i)))?void 0:l.format;if(n)return n.replaceAll("imageLink",e||"").replaceAll("imageName",t.split(".")[0])}return e},Wt=(e=!1)=>{const t=e?St.global.t("copy_success_1"):St.global.t("copy_success_2");o({type:e?"info":"success",message:t,duration:e?6e3:4e3})},qt=(e,t,a,l=!1)=>{const i=Xt(Ht(e,t,a),e.name,a);i?Lt(i,(()=>{Wt(l)})):o.error({message:St.global.t("copy_fail_1")})},Jt=(e,t,a,l=!1)=>{if((null==e?void 0:e.length)>0){let i="";e.forEach(((l,n)=>{const s=Xt(Ht(l,t,a),l.name,a);i+=`${s}${n<e.length-1?"\n":""}`})),Lt(i,(()=>{Wt(l)}))}},Kt=()=>{const{platform:e}=navigator;return e.includes("Mac")?"mac":e.includes("Win")?"win":e.includes("Linux")?"linux":null},Yt=()=>{const e={token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepo:"",repoList:[],branchMode:rt.repoBranch,branchList:[],selectedBranch:"",selectedDir:"",dirMode:dt.repoDir,dirList:[],logined:!1,selectedDirList:[],viewDir:""},t=localStorage.getItem("PICX_CONFIG");return t?(Ct(e,JSON.parse(t)),e.selectedBranch&&!e.branchList.length&&(e.branchList=[{value:e.selectedBranch,label:e.selectedBranch}]),e.dirMode===dt.autoDir&&(e.selectedDir=Ot("yyyyMMdd")),e):e},Qt={state:{userConfigInfo:Yt()},actions:{USER_CONFIG_INFO_RESET({state:e}){e.userConfigInfo=Yt()},SET_USER_CONFIG_INFO({state:e,dispatch:t},a){for(const l in a)e.userConfigInfo.hasOwnProperty(l)&&(e.userConfigInfo[l]=a[l]);t("USER_CONFIG_INFO_PERSIST")},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:t},a){e.userConfigInfo.dirList.some((e=>e.value===a))||(e.userConfigInfo.dirList.push({label:a,value:a}),t("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:t},a){const{dirList:l}=e.userConfigInfo;if(l.some((e=>e.value===a))){const e=l.findIndex((e=>e.value===a));l.splice(e,1),t("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){(e=>{const{selectedDir:t,selectedBranch:a,dirMode:l}=e.userConfigInfo;if("newDir"===l){const a=t.split("");let l=0,i="";const n=[" ",".","、",",","，","!","？","?"];for(let e=0;e<a.length&&(n.some((t=>t===a[e]))&&(a[e]="-"),"/"===a[e]&&(l+=1),!(l>=5));e++)i+=a[e];e.userConfigInfo.selectedDir=i}e.userConfigInfo.selectedBranch=a.replace(/\s+/g,"-")})(e),localStorage.setItem("PICX_CONFIG",JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_LOGOUT({state:e}){Dt(e.userConfigInfo)}},getters:{getUserLoginStatus:e=>e.userConfigInfo.logined,getUserConfigInfo:e=>e.userConfigInfo,getUserViewDir:e=>e.userConfigInfo.viewDir}},Zt={state:{imgCardArr:[]},mutations:{IMAGE_CARD(e,{imageObj:t}){const{uuid:a,checked:l}=t;l&&e.imgCardArr.forEach((e=>{e.uuid===a&&(e.checked=!0)}))},REPLACE_IMAGE_CARD(e,{checkedImgArr:t}){t.length>0?e.imgCardArr=t:e.imgCardArr=[]}},actions:{},getters:{getImageCardArr:e=>e.imgCardArr,getImageCardCheckedArr:e=>e.imgCardArr.filter((e=>e.checked))}},ea={state:{uploadAreaActive:!1},mutations:{CHANGE_UPLOAD_AREA_ACTIVE(e,t){e.uploadAreaActive=t},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.uploadAreaActive=!1}},getters:{getUploadAreaActive:e=>e.uploadAreaActive}};var ta,aa,la,ia;(aa=ta||(ta={}))[aa.add=0]="add",aa[aa.edit=1]="edit",(ia=la||(la={}))[ia.githubPages=0]="githubPages",ia[ia.vervel=1]="vervel";const na=(e,t,a,l)=>{const i=t===ta.add?a("settings.link_rule.add"):a("settings.link_rule.edit"),n=[];if(!e.rule.includes("{{path}}"))return o.error(a("settings.link_rule.error_msg_2",{action:i,path:"{{path}}"})),void l(!1);if(e.rule.includes("{{owner}}")||n.push("{{owner}}"),e.rule.includes("{{repo}}")||n.push("{{repo}}"),e.rule.includes("{{branch}}")||n.push("{{branch}}"),n.length){const e=a("settings.link_rule.error_msg_3",{action:i,rules:n.join("、")});p.confirm(e,`${i}`,{type:"warning",showClose:t===ta.add,showCancelButton:t===ta.add}).then((()=>{l(!0)})).catch((()=>{l(!1)}))}else l(!0)},sa={imageName:{autoAddHash:!0,autoTimestampNaming:!1,prefixNaming:{enable:!1,prefix:""}},compress:{enable:!0,encoder:it.webP},theme:{mode:ft.system},elementPlusSize:mt.default,imageLinkType:{selected:st.jsDelivr,presetList:{[`${st.GitHubPages}`]:{id:$t(),name:st.GitHubPages,rule:"https://{{owner}}.github.io/{{repo}}/{{path}}"},[`${st.GitHub}`]:{id:$t(),name:st.GitHub,rule:"https://github.com/{{owner}}/{{repo}}/raw/{{branch}}/{{path}}"},[`${st.jsDelivr}`]:{id:$t(),name:st.jsDelivr,rule:"https://cdn.jsdelivr.net/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},[`${st.Statically}`]:{id:$t(),name:st.Statically,rule:"https://cdn.statically.io/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},[`${st.ChinaJsDelivr}`]:{id:$t(),name:st.ChinaJsDelivr,rule:"https://jsd.cdn.zzko.cn/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},[`${st.rawGitHub}`]:{id:$t(),name:st.rawGitHub,rule:"https://raw.githubusercontent.com/{{owner}}/{{repo}}/{{branch}}/{{path}}"},[`${st.ghProxy}`]:{id:$t(),name:st.ghProxy,rule:"https://mirror.ghproxy.com/https://raw.githubusercontent.com/{{owner}}/{{repo}}/{{branch}}/{{path}}"},[`${st.moeyy}`]:{id:$t(),name:st.moeyy,rule:"https://github.moeyy.xyz/https://raw.githubusercontent.com/{{owner}}/{{repo}}/{{branch}}/{{path}}"}}},imageLinkFormat:{enable:!1,selected:"Markdown",presetList:[{name:"Markdown",format:"![imageName](imageLink)"},{name:"HTML",format:'<img src="imageLink" alt="imageName" />'},{name:"BBCode",format:"[img]imageLink[/img]"}]},starred:!1,watermark:{enable:!1,text:"PicX",fontSize:50,position:pt.rightBottom,textColor:"#FFFFFF",opacity:.5},deploy:{github:{uuid:$t(),status:null,latestTime:null,type:la.githubPages}},language:_t.zhCN},oa=h({modules:{dirImageListModule:Ze,userConfigInfoModule:Qt,imageCardModule:Zt,uploadAreaActiveModule:ea,userSettingsModule:{state:{userSettings:(()=>{const e=Ge("PICX_SETTINGS");return e&&Ct(sa,e),sa})()},actions:{SET_USER_SETTINGS({state:e,dispatch:t},a){for(const l in a)e.userSettings.hasOwnProperty(l)&&(e.userSettings[l]=a[l]);t("USER_SETTINGS_PERSIST")},ADD_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},{rule:a,$t:l}){const i=e.userSettings.imageLinkType.presetList;Object.hasOwn(i,a.name)?o.error(l("settings.link_rule.error_msg_1")):na(a,ta.add,l,(l=>{l&&(e.userSettings.imageLinkType.presetList[a.name]=a,t("USER_SETTINGS_PERSIST"))}))},UPDATE_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},{rule:a,$t:l}){na(a,ta.edit,l,(l=>{l&&(e.userSettings.imageLinkType.presetList[a.name].rule=a.rule,t("USER_SETTINGS_PERSIST"))}))},DEL_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},a){delete e.userSettings.imageLinkType.presetList[a.name],t("USER_SETTINGS_PERSIST")},USER_SETTINGS_PERSIST({state:e}){localStorage.setItem("PICX_SETTINGS",JSON.stringify(e.userSettings))},USER_SETTINGS_LOGOUT({state:e}){e.userSettings=sa}},getters:{getUserSettings:e=>e.userSettings}},toolboxImageListModule:{state:{toolboxImageList:[]},mutations:{},actions:{TOOLBOX_IMG_LIST_ADD({state:e},t){e.toolboxImageList.unshift(t)},TOOLBOX_IMG_LIST_REMOVE({state:e},t){if(e.toolboxImageList.length>0){const a=e.toolboxImageList.findIndex((e=>e.uuid===t));-1!==a&&e.toolboxImageList.splice(a,1)}},TOOLBOX_IMG_LIST_RESET({state:e}){e.toolboxImageList=[]}},getters:{getToolboxImageList:e=>e.toolboxImageList}},uploadImageListModule:{state:{uploadImageList:[]},mutations:{},actions:{UPLOAD_IMG_LIST_ADD({state:e},t){e.uploadImageList.unshift(t)},UPLOAD_IMG_LIST_REMOVE({state:e},t){if(e.uploadImageList.length>0){const a=e.uploadImageList.findIndex((e=>e.uuid===t));-1!==a&&0===e.uploadImageList[a].uploadStatus.progress&&e.uploadImageList.splice(a,1)}},UPLOAD_IMG_LIST_RESET({state:e}){e.uploadImageList=[]}},getters:{getUploadImageList:e=>e.uploadImageList}}},state:{rootName:"root"},mutations:{},actions:{LOGOUT({dispatch:e,commit:t}){t("UPLOAD_AREA_ACTIVE_LOGOUT"),e("DIR_IMAGE_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),e("USER_SETTINGS_LOGOUT"),e("TOOLBOX_IMG_LIST_RESET"),e("UPLOAD_IMG_LIST_RESET"),localStorage.clear(),sessionStorage.clear()}},getters:{}}),ra=Symbol("vuex-store");function ca(){return f(ra)}const da=(e,t="")=>{const{owner:a,selectedRepo:l,selectedBranch:i}=e;return new Promise((async e=>{const n=await Fe({url:`/repos/${a}/${l}/contents/${t}`,method:"GET",params:{ref:i}});n&&n.length?e(n.filter((e=>"dir"===e.type)).map((e=>({value:e.name,label:e.name})))):e(null)}))},ua=(e,t="")=>{const{owner:a,selectedRepo:l,selectedBranch:i}=e;return new Promise((async e=>{const n=await Fe({url:`/repos/${a}/${l}/contents/${t}`,method:"GET",params:{"no-cache":$t(),ref:i}});n&&n.length?(n.filter((e=>"dir"===e.type)).forEach((e=>oa.dispatch("DIR_IMAGE_LIST_ADD_DIR",e.path))),setTimeout((()=>{n.filter((e=>"file"===e.type&&Gt(zt(e.name)))).forEach((e=>{var a,l;oa.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",(a=e,l=t,{type:"image",uuid:$t(),dir:l,name:a.name,sha:a.sha,path:a.path,deleting:!1,size:a.size,checked:!1}))}))}),120),e(!0)):e(null)}))},ma=(e,t,a)=>Fe({url:`/repos/${e}/${t}/branches/${a}`,method:"GET"}),ga=(e,t)=>new Promise((async a=>{const l=await Fe({url:`/repos/${e}/${t}/branches`,method:"GET",cache:{maxAge:0},params:{timestamp:Date.now()}});l&&l.length?a(l.filter((e=>!e.protected)).map((e=>({value:e.name,label:e.name}))).reverse()):a([])})),pa=(e,t,a,l)=>Fe({url:`/repos/${e}/${t}/contents/${a}`,method:"DELETE",data:{owner:e,repo:t,path:a,message:"delete image",sha:l}}),ha=(e,t,a)=>Fe({url:`/repos/${t}/${a}/git/blobs`,method:"POST",params:{owner:t,repo:a,content:(e.base64.compressBase64||e.base64.watermarkBase64||e.base64.originalBase64).split(",")[1],encoding:"base64"}}),fa=(e,t,a,l)=>{var i,n,s;return Fe({url:`/repos/${e}/${t}/git/trees`,method:"POST",params:{tree:a.map((e=>({path:e.path,mode:"100644",type:"blob",sha:e.sha}))),base_tree:(null==(s=null==(n=null==(i=null==l?void 0:l.commit)?void 0:i.commit)?void 0:n.tree)?void 0:s.sha)||null}})},va=(e,t,a,l,i="")=>Fe({url:`/repos/${e}/${t}/git/commits`,method:"POST",params:{tree:a.sha,parents:[l.commit.sha],message:i||"upload images"}}),_a=(e,t,a,l)=>Fe({url:`/repos/${e}/${t}/git/refs/heads/${a}`,method:"PATCH",params:{sha:l}}),ba=v({__name:"repo-dir-cascader",props:{elKey:{type:String,default:""},elSize:{type:String,default:mt.default},elWidth:{type:String,default:"100%"},elClearable:{type:Boolean,default:!1}},setup(e){const t=ca(),a=_((()=>t.getters.getUserConfigInfo)).value,l={lazy:!0,checkStrictly:!0,async lazyLoad(e,t){const{level:l,pathLabels:i}=e;let n;n=0===l?a.dirList:await da(a,i.join("/")),t(n?n.map((e=>({value:e.value,label:e.label,leaf:l>=4}))):[])}},i=e=>{a.selectedDirList=e,a.selectedDir=e.join("/"),t.dispatch("USER_CONFIG_INFO_PERSIST")};return(t,n)=>{const s=b;return y(),w(s,{style:k({width:e.elWidth}),size:e.elSize,debounce:500,props:l,key:e.elKey,modelValue:I(a).selectedDirList,"onUpdate:modelValue":n[0]||(n[0]=e=>I(a).selectedDirList=e),filterable:"",placeholder:t.$t("config.placeholder5"),clearable:e.elClearable,onChange:i},null,8,["style","size","modelValue","placeholder","clearable"])}}}),ya={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},wa=[S("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"},null,-1)];var ka={name:"ep-refresh",render:function(e,t){return y(),x("svg",ya,[...wa])}},Ia=(e,t)=>{const a=e.__vccOpts||e;for(const[l,i]of t)a[l]=i;return a};var xa=Ia(v({__name:"refresh-config",props:{boxWidth:{type:Number,default:20},dataType:{type:String,default:"repo"}},setup(e){const t=C(),a=ca(),l=_((()=>a.getters.getUserConfigInfo)).value,i=e,n=async()=>{const e=r.service({lock:!0,text:t.proxy.$t("config.loading4",{type:t.proxy.$t(i.dataType)})}),{owner:n,selectedRepo:s}=l;if("repo"===i.dataType){const e=await We(n);e&&(l.repoList=e)}else if("branch"===i.dataType){const e=await ga(n,s);e.length&&(l.branchList=e)}e.close(),await a.dispatch("USER_CONFIG_INFO_PERSIST")};return(t,a)=>{const l=ka,i=T,s=$;return y(),x("div",{class:"refresh-config-box",style:k({width:e.boxWidth+"rem"})},[L(s,{placement:"top",content:t.$t("config.reload",{type:t.$t(e.dataType)})},{default:D((()=>[L(i,{class:"icon",onClick:n},{default:D((()=>[L(l)])),_:1})])),_:1},8,["content"])],4)}}}),[["__scopeId","data-v-5a9628e4"]]);const Sa=_((()=>oa.getters.getUserConfigInfo)).value,Ta=()=>{oa.dispatch("LOGOUT")},$a=()=>{oa.dispatch("USER_CONFIG_INFO_PERSIST")};function La(e){Sa.logined=!0,Sa.owner=e.login,Sa.name=e.name,Sa.email=e.email,Sa.avatarUrl=e.avatar_url,$a()}const Da=async e=>{const{selectedDir:t,dirMode:a}=Sa;let l=e("config.message6");if(""===t){switch(a){case dt.newDir:l=e("config.message7");break;case dt.repoDir:l=e("config.message8",{repo:Sa.selectedRepo})}o.warning({message:l})}else await Es.push("/upload")},Ca=async e=>{const{token:t}=Sa;if(!t)return void o.error({message:e("config.message1")});const a=r.service({lock:!0,text:e("config.loading6")});try{const t=await He(Sa.token);if(!t)return a.close(),void o.error({message:e("config.message2")});La(t);const l=await(e=>Fe({url:"/user/repos",method:"POST",params:{name:"picx-images-hosting",description:"PicX image hosting repository",private:!1},headers:{Authorization:`token ${e}`},success422:!0}))(Sa.token);if(!l)return a.close(),void o.error({message:e("config.message3")});Sa.repoList=[{value:"picx-images-hosting",label:"picx-images-hosting"}],Sa.selectedRepo="picx-images-hosting",Sa.branchList=[{value:"main",label:"main"}],Sa.selectedBranch="main",Sa.branchMode=rt.repoBranch,Sa.selectedDir=Ot("yyyyMMdd"),Sa.dirMode=dt.autoDir,Sa.dirList=[],$a(),await qe(Sa,!1),a.close(),o.success({message:e("config.message4")}),await Es.push("/upload")}catch(l){o.error({message:e("config.message5")}),console.error("oneClickAutoConfig >> ",l)}},Oa=e=>e.language===_t.en?"100rem":"70rem",Ea=e=>e.elementPlusSize===mt.large?"right":"top";const Ra={class:"page-container config-page-container"};var Na=Ia(v({__name:"my-config",setup(e){const t=ca(),a=C(),l=O(!1),i=O(!1),n=O(!1),s=O(32),r=_((()=>t.getters.getUserConfigInfo)).value,c=_((()=>t.getters.getUserLoginStatus)).value,d=_((()=>t.getters.getUserSettings)).value,u=_((()=>!r.token||!r.owner)),m=_((()=>l.value||i.value||n.value)),g=O(null),p=O("repoDirCascaderKey"),h=O(null),f=e=>{var t;switch(e){case dt.rootDir:r.selectedDir="/";break;case dt.autoDir:r.selectedDir=Ot("yyyyMMdd");break;case dt.newDir:r.selectedDir="xxx",null==(t=g.value)||t.focus();break;case dt.repoDir:r.dirList.length||(r.selectedDir="",r.selectedDirList=[]);break;default:r.selectedDir="/"}$a()};async function v(){i.value=!0;const e=await da(r);i.value=!1,e&&(r.dirList=e),$a()}async function b(){var e,t;if(!r.token)return void o.error({message:null==(e=null==a?void 0:a.proxy)?void 0:e.$t("config.message1")});u.value||(Sa.selectedRepo="",Sa.repoList=[],Sa.selectedBranch="",Sa.branchMode=rt.repoBranch,Sa.branchList=[],Sa.selectedDir="",Sa.dirMode=dt.repoDir,Sa.dirList=[]),l.value=!0;const i=await He(r.token);i?(La(i),await async function(e){var t;const i=await We(e);l.value=!1,i?(r.repoList=i,$a()):o.error({message:null==(t=null==a?void 0:a.proxy)?void 0:t.$t("config.message9")})}(i.login)):o.error({message:null==(t=null==a?void 0:a.proxy)?void 0:t.$t("config.message11")})}function S(e){r.branchList=[],r.dirList=[],t.dispatch("DIR_IMAGE_LOGOUT"),async function(e){n.value=!0;const{owner:t,dirMode:a}=r,l=await ga(t,e);n.value=!1,l.length>0?(r.branchList=l.filter((e=>"gh-pages"!==e.value)),r.selectedBranch=r.branchList[0].value,r.branchMode=rt.repoBranch,await v()):(r.selectedBranch="main",r.branchMode=rt.newBranch,await qe(r)),f(a),$a()}(e),$a()}async function T(e){r.selectedBranch=e,await v(),p.value=r.selectedBranch,r.selectedDir=r.dirList[0].value,r.selectedDirList=[r.selectedDir],$a()}return E((()=>c),(e=>{e||(l.value=!1,i.value=!1,n.value=!1)})),R((()=>{r.token||setTimeout((()=>{h.value.focus()}),100)})),(e,t)=>{const a=N,o=A,c=U,v=$,_=M,C=P,O=j,E=xa,R=z,K=G,Y=ba,Q=B;return y(),x("div",Ra,[L(_,{"label-width":I(Oa)(I(d)),"label-position":I(Ea)(I(d))},{default:D((()=>[L(o,{label:"Token"},{default:D((()=>[L(a,{ref_key:"tokenInputRef",ref:h,modelValue:I(r).token,"onUpdate:modelValue":t[0]||(t[0]=e=>I(r).token=e),clearable:"",autofocus:!I(r).token,type:"password","show-password":"",placeholder:e.$t("config.inputToken")},null,8,["modelValue","autofocus","placeholder"])])),_:1}),L(o,{class:"operation"},{default:D((()=>[L(v,{placement:"top",content:e.$t("config.manualConfiguration3")},{default:D((()=>[L(c,{disabled:m.value,plain:"",type:"info","native-type":"submit",onClick:t[1]||(t[1]=H((e=>b()),["prevent"]))},{default:D((()=>[X(W(u.value?e.$t("config.manualConfiguration1"):e.$t("config.manualConfiguration2")),1)])),_:1},8,["disabled"])])),_:1},8,["content"]),L(v,{placement:"top",content:e.$t("config.autoConfiguration3")},{default:D((()=>[L(c,{plain:"",disabled:m.value,type:"primary",onClick:t[2]||(t[2]=H((t=>I(Ca)(e.$t)),["prevent"]))},{default:D((()=>[X(W(u.value?e.$t("config.autoConfiguration1"):e.$t("config.autoConfiguration2")),1)])),_:1},8,["disabled"])])),_:1},8,["content"])])),_:1})])),_:1},8,["label-width","label-position"]),I(r).token&&I(r).owner?V((y(),w(_,{key:0,"label-width":I(Oa)(I(d)),"label-position":I(Ea)(I(d)),"element-loading-text":e.$t("config.loading1")},{default:D((()=>[I(r).owner?(y(),w(o,{key:0,label:e.$t("config.username")},{default:D((()=>[L(a,{modelValue:I(r).owner,"onUpdate:modelValue":t[3]||(t[3]=e=>I(r).owner=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])):F("",!0),I(r).email?(y(),w(o,{key:1,label:e.$t("config.email")},{default:D((()=>[L(a,{modelValue:I(r).email,"onUpdate:modelValue":t[4]||(t[4]=e=>I(r).email=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])):F("",!0),I(r).repoList.length?(y(),w(o,{key:2,label:e.$t("config.selectRepo")},{default:D((()=>[L(O,{modelValue:I(r).selectedRepo,"onUpdate:modelValue":t[5]||(t[5]=e=>I(r).selectedRepo=e),filterable:!0,style:k({width:"calc(100% - "+s.value+"rem)"}),placeholder:e.$t("config.placeholder1"),onChange:S},{default:D((()=>[(y(!0),x(q,null,J(I(r).repoList,((e,t)=>(y(),w(C,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","style","placeholder"]),L(E,{"box-width":s.value,"data-type":"repo"},null,8,["box-width"])])),_:1},8,["label"])):F("",!0)])),_:1},8,["label-width","label-position","element-loading-text"])),[[Q,l.value]]):F("",!0),I(r).token&&I(r).selectedRepo&&I(r).branchList.length?V((y(),w(_,{key:1,"label-width":I(Oa)(I(d)),"label-position":I(Ea)(I(d)),"element-loading-text":e.$t("config.loading2")},{default:D((()=>[I(r).branchList.length&&I(r).branchMode===I(rt).repoBranch?(y(),w(o,{key:0,label:e.$t("config.selectBranch")},{default:D((()=>[L(O,{modelValue:I(r).selectedBranch,"onUpdate:modelValue":t[6]||(t[6]=e=>I(r).selectedBranch=e),filterable:!0,style:k({width:"calc(100% - "+s.value+"rem)"}),placeholder:e.$t("config.placeholder2"),onChange:T},{default:D((()=>[(y(!0),x(q,null,J(I(r).branchList,((e,t)=>(y(),w(C,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","style","placeholder"]),L(E,{"box-width":s.value,"data-type":"branch"},null,8,["box-width"])])),_:1},8,["label"])):F("",!0)])),_:1},8,["label-width","label-position","element-loading-text"])),[[Q,n.value]]):F("",!0),I(r).token&&I(r).selectedBranch?V((y(),w(_,{key:2,"label-width":I(Oa)(I(d)),"label-position":I(Ea)(I(d)),"element-loading-text":e.$t("config.loading5")},{default:D((()=>[I(r).selectedBranch?(y(),w(o,{key:0,label:e.$t("config.dirMode")},{default:D((()=>[L(K,{modelValue:I(r).dirMode,"onUpdate:modelValue":t[7]||(t[7]=e=>I(r).dirMode=e),onChange:f},{default:D((()=>[L(v,{content:e.$t("config.inputNewDir"),placement:"top",offset:-1},{default:D((()=>[L(R,{label:"newDir"},{default:D((()=>[X(W(e.$t("config.createNewDir")),1)])),_:1})])),_:1},8,["content"]),L(v,{content:e.$t("config.rootDir2",{branch:I(r).selectedBranch}),placement:"top",offset:-1},{default:D((()=>[L(R,{label:"rootDir"},{default:D((()=>[X(W(e.$t("config.rootDir")),1)])),_:1})])),_:1},8,["content"]),L(v,{content:e.$t("config.autoDir2"),placement:"top",offset:-1},{default:D((()=>[L(R,{label:"autoDir"},{default:D((()=>[X(W(e.$t("config.autoDir")),1)])),_:1})])),_:1},8,["content"]),I(r).dirList.length&&"newBranch"!==I(r).branchMode?(y(),w(v,{key:0,content:e.$t("config.repoDir2",{branch:I(r).selectedBranch}),placement:"top",offset:-1},{default:D((()=>[L(R,{label:"repoDir"},{default:D((()=>[X(W(e.$t("config.repoDir",{repo:I(r).selectedRepo})),1)])),_:1})])),_:1},8,["content"])):F("",!0)])),_:1},8,["modelValue"])])),_:1},8,["label"])):F("",!0),"autoDir"===I(r).dirMode?(y(),w(o,{key:1,label:e.$t("config.autoDir")},{default:D((()=>[L(a,{modelValue:I(r).selectedDir,"onUpdate:modelValue":t[8]||(t[8]=e=>I(r).selectedDir=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])):F("",!0),"rootDir"===I(r).dirMode?(y(),w(o,{key:2,label:e.$t("config.rootDir")},{default:D((()=>[L(a,{modelValue:I(r).selectedDir,"onUpdate:modelValue":t[9]||(t[9]=e=>I(r).selectedDir=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])):F("",!0),"newDir"===I(r).dirMode?(y(),w(o,{key:3,label:e.$t("config.createNewDir")},{default:D((()=>[L(a,{ref_key:"newDirInputRef",ref:g,modelValue:I(r).selectedDir,"onUpdate:modelValue":t[10]||(t[10]=e=>I(r).selectedDir=e),onInput:t[11]||(t[11]=e=>I($a)()),clearable:"",placeholder:e.$t("config.placeholder4")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])):F("",!0),I(r).dirList.length&&"repoDir"===I(r).dirMode&&"newBranch"!==I(r).branchMode?(y(),w(o,{key:4,label:e.$t("config.selectDir")},{default:D((()=>[L(Y,{"el-key":p.value,"el-size":I(d).elementPlusSize},null,8,["el-key","el-size"])])),_:1},8,["label"])):F("",!0)])),_:1},8,["label-width","label-position","element-loading-text"])),[[Q,i.value]]):F("",!0),I(r).token?(y(),w(_,{key:3,"label-width":I(Oa)(I(d)),"label-position":I(Ea)(I(d))},{default:D((()=>[L(o,{class:"operation"},{default:D((()=>[I(r).owner?(y(),w(c,{key:0,plain:"",disabled:m.value,type:"warning",onClick:t[12]||(t[12]=e=>I(Ta)())},{default:D((()=>[X(W(e.$t("reset")),1)])),_:1},8,["disabled"])):F("",!0),I(r).selectedRepo?(y(),w(c,{key:1,plain:"",disabled:m.value,type:"primary",onClick:t[13]||(t[13]=t=>I(Da)(e.$t))},{default:D((()=>[X(W(e.$t("confirm")),1)])),_:1},8,["disabled"])):F("",!0)])),_:1})])),_:1},8,["label-width","label-position"])):F("",!0)])}}}),[["__scopeId","data-v-9a1a2cc2"]]);const Aa=e=>{switch(e){case la.githubPages:return"GitHub Pages";case la.vervel:return"Vercel";default:return"GitHub Pages"}};const Ua={class:"deploy-box border-box"},Ma={class:"left-wrap"},Pa={key:0,class:"deploy-datetime info-item"},ja={class:"deploy-server info-item"},za={class:"deploy-status info-item"},Ga={class:"right-wrap"};var Ba=Ia(v({__name:"image-hosting-deploy",props:{disabled:{type:Boolean,default:!1}},setup(e){const t=C(),a=_((()=>oa.getters.getUserSettings)).value,l=_((()=>oa.getters.getUserConfigInfo)).value,i=e=>{var i;switch(e.type){case la.githubPages:return void(async(e,t,a)=>{var l;const{owner:i,selectedRepo:n,selectedBranch:s}=e,o=r.service({text:t("settings.image_hosting_deploy.deploying")}),c=(e=!1)=>{a&&a(e),o.close()};try{const e=(await ga(i,n)).some((e=>"gh-pages"===e.value));let t=!0;if(e){if(t=!1,!(await Ve.delete(`/repos/${i}/${n}/git/refs/heads/gh-pages`)))return void c(!1);t=!0}if(t){let e="";const t=await Fe({url:`/repos/${i}/${n}/git/refs/heads/${s}`,method:"GET"});if(t&&(e=null==(l=null==t?void 0:t.object)?void 0:l.sha),!e)return void c(!1);(await Fe({url:`/repos/${i}/${n}/git/refs`,method:"POST",params:{ref:"refs/heads/gh-pages",sha:e}})).object.sha?setTimeout((()=>{c(!0)}),5e4):c(!1)}}catch(d){console.error(d),c(!1)}})(l,null==(i=null==t?void 0:t.proxy)?void 0:i.$t,(e=>{var l,i;a.deploy.github.status=e,a.deploy.github.latestTime=Date.now(),e?(a.imageLinkType.selected=st.GitHubPages,oa.dispatch("USER_SETTINGS_PERSIST"),o.success(null==(l=null==t?void 0:t.proxy)?void 0:l.$t("settings.image_hosting_deploy.success"))):o.error(null==(i=null==t?void 0:t.proxy)?void 0:i.$t("settings.image_hosting_deploy.fail2"))}));case la.vervel:}};return(t,l)=>{const n=U,s=$;return y(),x("div",Ua,[(y(!0),x(q,null,J(I(a).deploy,((a,l)=>(y(),x("div",{class:"deploy-item border-box",key:l+a.uuid},[S("div",Ma,[S("span",{class:K(["deploy-status-icon info-item",{success:!0===a.status,fail:!1===a.status}])},null,2),a.latestTime?(y(),x("span",Pa,W(I(Ot)("yyyy-MM-dd hh:mm:ss",a.latestTime)),1)):F("",!0),S("span",ja,W(I(Aa)(a.type)),1),S("span",za,W(null===a.status?t.$t("settings.image_hosting_deploy.not_deployed"):!0===a.status?t.$t("settings.image_hosting_deploy.success"):t.$t("settings.image_hosting_deploy.fail")),1)]),S("div",Ga,[L(s,{placement:"top",content:t.$t("settings.image_hosting_deploy.deploy_to",{server:I(Aa)(a.type)})},{default:D((()=>[L(n,{type:"primary",disabled:e.disabled&&null!==a.status,text:"",onClick:e=>i(a)},{default:D((()=>[X(W(t.$t("settings.image_hosting_deploy.one_click_deploy")),1)])),_:2},1032,["disabled","onClick"])])),_:2},1032,["content"])])])))),128))])}}}),[["__scopeId","data-v-63934274"]]);const Va={key:0,class:"selected-info-bar-box"},Fa={class:"info-item repo"},Ha={key:0,class:"info-item branch"},Xa={class:"info-item dir"};var Wa=Ia(v({__name:"selected-info-bar",props:{barType:{type:String,default:"upload"}},setup(e){const t=ca(),a=_((()=>t.getters.getUserConfigInfo)),l=_((()=>t.getters.getUserSettings));return(t,i)=>{const n=Y,s=ba;return a.value.selectedRepo?(y(),x("div",Va,[S("span",Fa,[X(W(t.$t("repo"))+"： ",1),L(n,{"disable-transitions":""},{default:D((()=>[X(W(a.value.selectedRepo),1)])),_:1})]),a.value.selectedBranch?(y(),x("span",Ha,[X(W(t.$t("branch"))+"： ",1),L(n,{"disable-transitions":""},{default:D((()=>[X(W(a.value.selectedBranch),1)])),_:1})])):F("",!0),S("span",Xa,[X(W(t.$t("dir"))+"： ",1),a.value.dirMode!==I(dt).repoDir||"management"===e.barType?(y(),w(n,{key:0,"disable-transitions":""},{default:D((()=>[X(W("management"===e.barType?a.value.viewDir:a.value.selectedDir),1)])),_:1})):F("",!0),a.value.dirMode===I(dt).repoDir&&"upload"===e.barType?(y(),w(s,{key:1,"el-size":l.value.elementPlusSize===I(mt).large?I(mt).default:l.value.elementPlusSize,"el-width":"","el-clearable":!1},null,8,["el-size"])):F("",!0)])])):F("",!0)}}}),[["__scopeId","data-v-85ad3a00"]]);const qa={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ja=[S("path",{fill:"currentColor",d:"M544 864V672h128L512 480L352 672h128v192H320v-1.6c-5.376.32-10.496 1.6-16 1.6A240 240 0 0 1 64 624c0-123.136 93.12-223.488 212.608-237.248A239.808 239.808 0 0 1 512 192a239.872 239.872 0 0 1 235.456 194.752c119.488 13.76 212.48 114.112 212.48 237.248a240 240 0 0 1-240 240c-5.376 0-10.56-1.28-16-1.6v1.6z"},null,-1)];var Ka={name:"ep-upload-filled",render:function(e,t){return y(),x("svg",qa,[...Ja])}};const Ya=(e=>(Z("data-v-ecea3c70"),e=e(),ee(),e))((()=>S("label",{for:"input-file-selector"},null,-1))),Qa={key:0,class:"upload-area-tips"},Za={class:"text"},el=["src"];var tl=Ia(v({__name:"getting-images",props:{disabled:{type:Boolean,default:!1}},emits:["getImgList"],setup(e,{expose:t,emit:a}){const l=ca(),i=_((()=>l.getters.getUploadAreaActive)),n=O({uuid:"",base64:""}),s=O([]),o=a,r=()=>{const e=s.value.length,t=e>0?s.value[e-1]:{uuid:"",base64:""};n.value={uuid:t.uuid,base64:t.base64}},c=async e=>{if(e.length){s.value=[];for(const t of e){const e=await Vt(t);e&&s.value.push(e)}r(),l.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0),o("getImgList",s.value)}},d=async e=>{const t=e.target;await c(t.files),t.value="",t.value=t.defaultValue},u=async e=>{await c(e.dataTransfer.files)},m=async e=>{const t=Array.from(e.clipboardData.items).filter((e=>"file"===e.kind&&Gt(e.type))).map((e=>e.getAsFile()));await c(t)};return R((()=>{window.addEventListener("paste",m)})),Q((()=>{window.removeEventListener("paste",m)})),t({reset:()=>{s.value=[],n.value.uuid="",n.value.base64=""},remove:e=>{const t=s.value.findIndex((t=>t.uuid===e));-1!==t&&s.value.splice(t,1),e===n.value.uuid&&r()}}),(t,a)=>{const l=Ka,s=T;return y(),x("div",{class:K(["getting-images-container",{focus:i.value&&n.value.base64,disabled:e.disabled}]),onDragover:a[0]||(a[0]=H((()=>{}),["prevent"])),onDrop:H(u,["stop","prevent"]),onPaste:H(m,["stop"])},[Ya,S("input",{id:"input-file-selector",type:"file",accept:"image/*",onChange:d,multiple:"multiple"},null,32),n.value.base64?F("",!0):(y(),x("div",Qa,[L(s,{class:"icon"},{default:D((()=>[L(l)])),_:1}),S("div",Za,W(t.$t("upload.uploadAreaTips")),1)])),n.value.base64?(y(),x("img",{key:1,class:"preview-img",src:n.value.base64},null,8,el)):F("",!0)],34)}}}),[["__scopeId","data-v-ecea3c70"]]);const al=_((()=>oa.getters.getUserSettings)).value,ll=async e=>{const{starred:t}=e;if(!t){await((e="XPoet/picx")=>Fe({url:`/user/starred/${e}`,method:"PUT",data:{},noShowErrorMsg:!0}))()&&await oa.dispatch("SET_USER_SETTINGS",{starred:!0})}},il=(e,t,a)=>{var l;let i=a.selectedDir;(null==(l=null==t?void 0:t.reUploadInfo)?void 0:l.isReUpload)&&(i=t.reUploadInfo.dir),t.uploadStatus.progress=100,t.uploadStatus.uploading=!1;const n={checked:!1,type:"image",uuid:t.uuid,dir:i,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size};t.uploadedImg=n,oa.dispatch("DIR_IMAGE_LIST_ADD_DIR",i),oa.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",n)};function nl(e,t,a){const{selectedBranch:l,email:i,owner:n}=e,s={message:a||"upload image",branch:l,content:(t.base64.compressBase64||t.base64.watermarkBase64||t.base64.originalBase64).split(",")[1]};return i&&(s.committer={name:n,email:i}),t.uploadStatus.uploading=!0,new Promise((async a=>{const l=await((e,t)=>Fe({url:e,method:"PUT",data:t}))(((e,t)=>{var a;const{owner:l,selectedRepo:i,selectedDir:n}=e,s=t.filename.final;let o=s;return"/"!==n&&(o=`${n}/${s}`),(null==(a=null==t?void 0:t.reUploadInfo)?void 0:a.isReUpload)&&(o=t.reUploadInfo.path),`/repos/${l}/${i}/contents/${o}`})(e,t),s);if(t.uploadStatus.uploading=!1,l){const{name:i,sha:n,path:s,size:o}=l.content;il({name:i,sha:n,path:s,size:o},t,e),a(!0)}else a(!1)}))}const sl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ol=[S("path",{fill:"currentColor",d:"M406.656 706.944L195.84 496.256a32 32 0 1 0-45.248 45.248l256 256l512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"},null,-1)];var rl={name:"ep-check",render:function(e,t){return y(),x("svg",sl,[...ol])}};const cl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},dl=[S("path",{fill:"currentColor",d:"M160 832h704a32 32 0 1 1 0 64H160a32 32 0 1 1 0-64m384-578.304V704h-64V247.296L237.248 490.048L192 444.8L508.8 128l316.8 316.8l-45.312 45.248z"},null,-1)];var ul={name:"ep-upload",render:function(e,t){return y(),x("svg",cl,[...dl])}};const ml={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},gl=[S("path",{fill:"currentColor",d:"M352 480h320a32 32 0 1 1 0 64H352a32 32 0 0 1 0-64"},null,-1),S("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768a384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896a448 448 0 0 1 0 896"},null,-1)];var pl={name:"ep-remove",render:function(e,t){return y(),x("svg",ml,[...gl])}};const hl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},fl=[S("path",{fill:"currentColor",d:"M672 192L288 511.936L672 832z"},null,-1)];var vl={name:"ep-caret-left",render:function(e,t){return y(),x("svg",hl,[...fl])}};const _l={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},bl=[S("path",{fill:"currentColor",d:"m192 384l320 384l320-384z"},null,-1)];var yl={name:"ep-caret-bottom",render:function(e,t){return y(),x("svg",_l,[...bl])}};const wl=(e,t)=>{t.filename.isPrefixNaming=e,t.filename.name=e?`${t.filename.prefixName}${t.filename.initName}`:`${t.filename.initName}`,t.filename.isAddHash?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},kl=(e,t)=>{t.filename.isAddHash=e,t.filename.final=e?`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:`${t.filename.name}.${t.filename.suffix}`};const Il=["element-loading-text"],xl={class:"before-upload-handle-container"},Sl={class:"img-name text-ellipsis"},Tl={class:"operate-item"},$l={class:"operate-item"},Ll={class:"operate-item"},Dl={key:0,class:"operate-item"},Cl={key:1,class:"img-info-box"},Ol={class:"file-size-box"},El={key:0,class:"finial-file-size file-size-item"},Rl={class:"last-modified"};var Nl=Ia(v({__name:"upload-image-card",props:{imgObj:{type:Object,require:!0,default:()=>({})}},emits:["remove"],setup(e,{emit:t}){const a=ca(),l=C(),i=e,n=t,s=O(null),o=_((()=>a.getters.getUserSettings)).value,r=_((()=>a.getters.getUserConfigInfo)).value,c=O(""),d=te({isHash:!1,isPrefixNaming:!1,isTimestampNaming:!1,isRename:!1,newName:""}),u=O(!0),m=()=>{var e,t;i.imgObj.filename.newName=d.newName,setTimeout((()=>{var e;null==(e=s.value)||e.focus()}),100),e=d.isRename,(t=i.imgObj).filename.isRename=e,e?t.filename.name=t.filename.newName.trim().replace(/\s+/g,"-"):wl(t.filename.isPrefixNaming,t),t.filename.isAddHash?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},g=e=>{const{suffix:t,isPrefixNaming:a,isAddHash:l}=i.imgObj.filename;e?(d.isHash=!1,d.isPrefixNaming=!1,i.imgObj.filename.final=`${Date.now()}.${t}`):(wl(a,i.imgObj),kl(l,i.imgObj),d.isHash=l,d.isPrefixNaming=a)};return E((()=>i.imgObj.uploadStatus),(e=>{e.uploading&&(c.value=l.proxy.$t("upload.loading1"))}),{deep:!0,immediate:!0}),R((async()=>{await(async(e,t)=>{const{watermark:a,compress:l}=t;let i=e.fileInfo.originalFile;var n;a.enable&&a.text&&!e.fileInfo.watermarkFile&&(e.beforeUploadStatus.watermarking=!0,e.fileInfo.watermarkFile=(n=e.fileInfo.originalFile.type,/(png|jpg|jpeg|webp|avif)$/.test(n)?await Nt(e.fileInfo.originalFile,a):e.fileInfo.originalFile),i=e.fileInfo.watermarkFile,e.base64.watermarkBase64=await Mt(i),e.beforeUploadStatus.watermarking=!1),l.enable&&!e.fileInfo.compressFile&&(e.beforeUploadStatus.compressing=!0,e.fileInfo.compressFile=await Ft(i,l.encoder),i=e.fileInfo.compressFile,e.base64.compressBase64=await Mt(i),e.filename.suffix=zt(i.name),e.beforeUploadStatus.compressing=!1)})(i.imgObj,o),(()=>{const{imageName:e}=o;0===i.imgObj.uploadStatus.progress&&(i.imgObj.filename.isTimestampNaming=e.autoTimestampNaming,i.imgObj.filename.isTimestampNaming?(i.imgObj.filename.isAddHash=!1,i.imgObj.filename.isPrefixNaming=!1,g(!0)):(i.imgObj.filename.isAddHash=e.autoAddHash,i.imgObj.filename.isPrefixNaming=e.prefixNaming.enable,i.imgObj.filename.prefixName=e.prefixNaming.prefix,wl(e.prefixNaming.enable,i.imgObj),kl(e.autoAddHash,i.imgObj)),d.isTimestampNaming=i.imgObj.filename.isTimestampNaming,d.isHash=i.imgObj.filename.isAddHash,d.isPrefixNaming=i.imgObj.filename.isPrefixNaming,d.isRename=i.imgObj.filename.isRename,d.newName=i.imgObj.filename.newName)})()})),(t,a)=>{var l,p,h,f,v,_,b,k;const C=ae,O=yl,E=vl,R=T,A=$,U=le,M=N,P=pl,j=ul,z=rl,G=B;return y(),x("div",{class:K(["upload-image-card-container",{"wait-upload":!e.imgObj.uploadStatus.uploading&&0===e.imgObj.uploadStatus.progress,uploading:e.imgObj.uploadStatus.uploading&&100!==e.imgObj.uploadStatus.progress,uploaded:!e.imgObj.uploadStatus.uploading&&100===e.imgObj.uploadStatus.progress}])},[V((y(),x("div",{class:"img-show-container","element-loading-text":c.value},[L(C,{src:e.imgObj.base64.compressBase64||e.imgObj.base64.watermarkBase64||e.imgObj.base64.originalBase64,fit:"cover",loading:"lazy","hide-on-click-modal":!0,"preview-src-list":[e.imgObj.base64.compressBase64||e.imgObj.base64.watermarkBase64||e.imgObj.base64.originalBase64]},null,8,["src","preview-src-list"])],8,Il)),[[G,e.imgObj.uploadStatus.uploading||e.imgObj.beforeUploadStatus.compressing||e.imgObj.beforeUploadStatus.watermarking]]),S("div",xl,[S("div",{class:K(["img-name-box",{"no-border":100===e.imgObj.uploadStatus.progress}])},[S("span",Sl,W(e.imgObj.filename.final||e.imgObj.filename.name),1),0===e.imgObj.uploadStatus.progress?(y(),w(A,{key:0,placement:"top",offset:8,content:u.value?t.$t("upload.expand"):t.$t("upload.fold")},{default:D((()=>[L(R,{class:"fold-btn",onClick:a[0]||(a[0]=e=>u.value=!u.value)},{default:D((()=>[u.value?F("",!0):(y(),w(O,{key:0})),u.value?(y(),w(E,{key:1})):F("",!0)])),_:1})])),_:1},8,["content"])):F("",!0)],2),0===e.imgObj.uploadStatus.progress?(y(),x("div",{key:0,class:K(["img-name-operate-box",{folded:u.value}])},[S("div",Tl,[L(U,{label:t.$t("upload.hash"),modelValue:d.isHash,"onUpdate:modelValue":a[1]||(a[1]=e=>d.isHash=e),onChange:a[2]||(a[2]=e=>{return t=e,d.isTimestampNaming=!1,void kl(t,i.imgObj);var t})},null,8,["label","modelValue"])]),S("div",$l,[L(U,{label:t.$t("upload.rename"),modelValue:d.isRename,"onUpdate:modelValue":a[3]||(a[3]=e=>d.isRename=e),onChange:m},null,8,["label","modelValue"]),e.imgObj.filename.isRename?(y(),w(M,{key:0,class:"rename-input",size:"small",modelValue:d.newName,"onUpdate:modelValue":a[4]||(a[4]=e=>d.newName=e),onInput:m,maxlength:I(72),ref_key:"renameInputRef",ref:s,clearable:""},null,8,["modelValue","maxlength"])):F("",!0)]),S("div",Ll,[L(U,{label:t.$t("upload.timestamp-naming"),modelValue:d.isTimestampNaming,"onUpdate:modelValue":a[5]||(a[5]=e=>d.isTimestampNaming=e),onChange:g},null,8,["label","modelValue"])]),!e.imgObj.filename.isRename&&I(o).imageName.prefixNaming.enable&&I(o).imageName.prefixNaming.prefix?(y(),x("div",Dl,[L(U,{label:t.$t("upload.prefixNaming"),modelValue:d.isPrefixNaming,"onUpdate:modelValue":a[6]||(a[6]=e=>d.isPrefixNaming=e),onChange:a[7]||(a[7]=e=>{return t=e,d.isTimestampNaming=!1,void wl(t,i.imgObj);var t})},null,8,["label","modelValue"])])):F("",!0)],2)):F("",!0),0===e.imgObj.uploadStatus.progress?(y(),x("div",Cl,[S("div",Ol,[S("span",{class:K(["original-file-size file-size-item",{"del-line":null==(p=null==(l=e.imgObj.fileInfo)?void 0:l.compressFile)?void 0:p.size}])},W(I(Bt)(null==(h=e.imgObj.fileInfo.originalFile)?void 0:h.size))+" KB ",3),(null==(v=null==(f=e.imgObj.fileInfo)?void 0:f.compressFile)?void 0:v.size)?(y(),x("span",El,W(I(Bt)(null==(b=null==(_=e.imgObj.fileInfo)?void 0:_.compressFile)?void 0:b.size))+" KB ",1)):F("",!0)]),S("span",Rl,W(I(Ot)("yyyy-MM-dd hh:mm",null==(k=e.imgObj.fileInfo.originalFile)?void 0:k.lastModified)),1)])):F("",!0)]),100===e.imgObj.uploadStatus.progress?(y(),x("div",{key:0,class:"after-upload-handle-container flex-center",onClick:a[8]||(a[8]=t=>I(qt)(e.imgObj.uploadedImg,I(r),I(o)))},W(t.$t("upload.copyLink")),1)):F("",!0),0===e.imgObj.uploadStatus.progress?(y(),w(A,{key:1,placement:"top",offset:8,content:t.$t("upload.delete")},{default:D((()=>[L(R,{class:"del-img-btn",onClick:a[9]||(a[9]=t=>{return a=e.imgObj.uuid,void n("remove",a);var a})},{default:D((()=>[L(P)])),_:1})])),_:1},8,["content"])):F("",!0),S("div",{class:K(["upload-status-box",{"wait-upload":!e.imgObj.uploadStatus.uploading&&0===e.imgObj.uploadStatus.progress,uploaded:!e.imgObj.uploadStatus.uploading&&100===e.imgObj.uploadStatus.progress}])},[L(R,null,{default:D((()=>[e.imgObj.uploadStatus.uploading||0!==e.imgObj.uploadStatus.progress?F("",!0):(y(),w(j,{key:0})),e.imgObj.uploadStatus.uploading||100!==e.imgObj.uploadStatus.progress?F("",!0):(y(),w(z,{key:1}))])),_:1})],2)],2)}}}),[["__scopeId","data-v-a7836f2a"]]);const Al={class:"upload-page-container"},Ul={key:0,class:"upload-page-left page-container",style:{width:"300rem"}},Ml={class:"row-item"},Pl={class:"content-box"},jl={class:"row-item"},zl={class:"content-box upload-area-status"},Gl={key:0},Bl={class:"row-item"},Vl={class:"content-box"},Fl={key:0,class:"row-item"},Hl={class:"content-box operation-btn"},Xl={class:"shortcut-key"},Wl={class:"shortcut-key"},ql=v({__name:"upload-image",setup(e){const t=ca(),a=ie(),l=C(),i=O(null),s=_((()=>t.getters.getUserConfigInfo)).value,r=_((()=>t.getters.getUserSettings)).value,c=_((()=>t.getters.getUserLoginStatus)),d=O([]),u=O(!1),m=_((()=>"mac"===Kt()?"Command":"Ctrl")),g=O(""),p=O(!1),h=e=>{e.forEach((e=>{t.dispatch("UPLOAD_IMG_LIST_ADD",(e=>{const t={uuid:"",base64:{originalBase64:"",watermarkBase64:null,compressBase64:null},fileInfo:{originalFile:null,watermarkFile:null,compressFile:null},filename:{hash:"",suffix:"",name:"",prefixName:"",final:"",initName:"",newName:"",isAddHash:!0,isRename:!1,isPrefixNaming:!1,isTimestampNaming:!1},beforeUploadStatus:{watermarking:!1,compressing:!1},uploadStatus:{progress:0,uploading:!1},reUploadInfo:{dir:"",path:"",isReUpload:!1}};t.uuid=e.uuid,t.base64.originalBase64=e.base64,t.fileInfo.originalFile=e.file;const{imageName:a}=al,l=e.uuid,i=e.file.name.trim().replaceAll(" ","-"),n=i.lastIndexOf("."),s=i.slice(0,n),o=i.slice(n+1);return t.filename.initName=s,t.filename.name=a.prefixNaming.enable?`${a.prefixNaming.prefix}${s}`:s,t.filename.prefixName=a.prefixNaming.prefix,t.filename.hash=l,t.filename.suffix=o,t.filename.final=a.autoAddHash?`${t.filename.name}.${l}.${o}`:`${t.filename.name}.${o}`,t.filename.isAddHash=a.autoAddHash,t.filename.isPrefixNaming=a.prefixNaming.enable,t.filename.isTimestampNaming=a.autoTimestampNaming,t})(e))}))},f=()=>{var e;null==(e=i.value)||e.reset()},v=async e=>1===e.length?await nl(s,e[0],g.value)?et.uploaded:et.uploadFail:e.length>1?await async function(e,t,a){const{selectedBranch:l,selectedRepo:i,selectedDir:s,owner:r}=e,c=[];for(const p of t){p.uploadStatus.uploading=!0;const e=await ha(p,r,i);e?c.push(n({img:p},e)):(p.uploadStatus.uploading=!1,o.error(`${p.filename.final} 上传失败`))}const d=await ma(r,i,l);if(!d)return Promise.resolve(!1);const u="/"===s?"":`${s}/`,m=await fa(r,i,c.map((e=>({sha:e.sha,path:`${u}${e.img.filename.final}`}))),d);if(!m)return Promise.resolve(!1);const g=await va(r,i,m,d,a);return g&&await _a(r,i,l,g.sha)?(c.forEach((t=>{const a=t.img.filename.final;il({name:a,sha:t.sha,path:`${u}${a}`,size:0},t.img,e)})),Promise.resolve(!0)):Promise.resolve(!1)}(s,e,g.value)?et.allUploaded:et.uploadFail:void 0,b=async(e,a=!1)=>{f(),a?Jt(e,s,r,!0):qt(e[0],s,r,!0),await t.dispatch("SET_USER_CONFIG_INFO",{viewDir:s.selectedDir}),await ll(r)},k=async()=>{var e,t,i,n,r,c,m;const{token:g,selectedRepo:p,selectedDir:h}=s;if(!g)return o.error({message:null==(e=null==l?void 0:l.proxy)?void 0:e.$t("upload.message1")}),void(await a.push("/config"));if(!p)return o.error({message:null==(t=null==l?void 0:l.proxy)?void 0:t.$t("upload.message2")}),void(await a.push("/config"));if(!h)return o.error({message:null==(i=null==l?void 0:l.proxy)?void 0:i.$t("upload.message3")}),void(await a.push("/config"));const f=d.value.filter((e=>0===e.uploadStatus.progress));if(0===f.length)return void o.error({message:null==(n=null==l?void 0:l.proxy)?void 0:n.$t("upload.message4")});u.value=!0;const _=await v(f);u.value=!1;const y=f.filter((e=>100===e.uploadStatus.progress)).map((e=>e.uploadedImg));switch(_){case et.uploaded:o.success({message:null==(r=null==l?void 0:l.proxy)?void 0:r.$t("upload.message5")}),await b(y);break;case et.allUploaded:o.success({message:null==(c=null==l?void 0:l.proxy)?void 0:c.$t("upload.message6")}),await b(y,!0);break;case et.uploadFail:o.error({message:null==(m=null==l?void 0:l.proxy)?void 0:m.$t("upload.message7")})}},T=()=>{u.value=!1,p.value=!1,t.dispatch("UPLOAD_IMG_LIST_RESET"),f()};E((()=>c),(e=>{!e&&T()})),E((()=>t.state.uploadImageListModule.uploadImageList),(e=>{d.value=e,p.value=d.value.some((e=>100===e.uploadStatus.progress))}),{immediate:!0,deep:!0});return R((()=>{document.addEventListener("keydown",(e=>{const t=e.keyCode||e.which||e.charCode,a=e.ctrlKey||e.metaKey;a&&65===t&&d.value.length&&(T(),e.preventDefault()),a&&83===t&&(u.value||(k(),e.preventDefault()))}))})),(e,a)=>{const l=tl,n=Wa,s=N,o=A,c=Ba,f=U;return y(),x("div",Al,[!d.value.length||I(r).elementPlusSize!==I(mt).large&&I(r).elementPlusSize!==I(mt).default?F("",!0):(y(),x("div",Ul,[(y(!0),x(q,null,J(d.value,((e,l)=>(y(),x("div",{class:"uploaded-item",key:l+e.uuid},[L(Nl,{"img-obj":e,onRemove:a[0]||(a[0]=e=>{return a=e,t.dispatch("UPLOAD_IMG_LIST_REMOVE",a),void(null==(l=i.value)||l.remove(a));var a,l})},null,8,["img-obj"])])))),128))])),S("div",{class:K(["upload-page-right page-container",{"has-left":d.value.length}])},[S("div",Ml,[S("div",Pl,[L(l,{disabled:u.value,ref_key:"gettingImagesRef",ref:i,onGetImgList:h},null,8,["disabled"])])]),S("div",jl,[S("div",zl,[L(n),d.value.length?(y(),x("div",Gl,W(e.$t("upload.uploaded"))+"："+W(d.value.filter((e=>100===e.uploadStatus.progress)).length)+" / "+W(d.value.length),1)):F("",!0)])]),S("div",Bl,[S("div",Vl,[d.value.length?(y(),w(o,{key:0},{default:D((()=>[L(s,{modelValue:g.value,"onUpdate:modelValue":a[1]||(a[1]=e=>g.value=e),placeholder:e.$t("config.inputCommits")},null,8,["modelValue","placeholder"])])),_:1})):F("",!0),L(c,{disabled:!p.value},null,8,["disabled"])])]),d.value.length?(y(),x("div",Fl,[S("div",Hl,[L(f,{disabled:u.value,plain:"",type:"warning",onClick:T},{default:D((()=>[X(W(e.$t("reset"))+" ",1),S("span",Xl,"[ "+W(m.value)+" + A ]",1)])),_:1},8,["disabled"]),L(f,{disabled:u.value,plain:"",type:"primary",onClick:k},{default:D((()=>[X(W(e.$t("upload.upload"))+" ",1),S("span",Wl,"[ "+W(m.value)+" + S ]",1)])),_:1},8,["disabled"])])])):F("",!0)],2)])}}}),Jl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Kl=[S("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224a112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224a112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224a112 112 0 0 1 0-224"},null,-1)];var Yl={name:"ep-more-filled",render:function(e,t){return y(),x("svg",Jl,[...Kl])}};const Ql={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Zl=[S("path",{fill:"currentColor",d:"M768 832a128 128 0 0 1-128 128H192A128 128 0 0 1 64 832V384a128 128 0 0 1 128-128v64a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64z"},null,-1),S("path",{fill:"currentColor",d:"M384 128a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64zm0-64h448a128 128 0 0 1 128 128v448a128 128 0 0 1-128 128H384a128 128 0 0 1-128-128V192A128 128 0 0 1 384 64"},null,-1)];var ei={name:"ep-copy-document",render:function(e,t){return y(),x("svg",Ql,[...Zl])}};const ti={class:"copy-image-link-box border-box"};var ai=Ia(v({__name:"copy-image-link",props:{imgObj:{type:Object,default:()=>{}}},setup(e){const t=e,a=_((()=>oa.getters.getUserSettings)).value,l=_((()=>oa.getters.getUserConfigInfo)).value,i=_((()=>a.imageLinkFormat.enable?`${a.imageLinkType.selected} & ${a.imageLinkFormat.selected}`:`${a.imageLinkType.selected}`));let n=O(t.imgObj).value;const s=()=>{qt(n,l,a)};return ne((()=>{n=t.imgObj})),(e,t)=>{const a=ei,l=T,n=U,o=$;return y(),x("div",ti,[L(o,{content:i.value,placement:"top"},{default:D((()=>[L(n,{plain:"",type:"primary",size:"default",onClick:s},{default:D((()=>[L(l,null,{default:D((()=>[L(a)])),_:1}),X(" "+W(e.$t("upload.copyLink")),1)])),_:1})])),_:1},8,["content"])])}}}),[["__scopeId","data-v-0a0b6b22"]]);const li={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ii=[S("path",{fill:"currentColor",d:"M764.288 214.592L512 466.88L259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512L214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null,-1)];var ni={name:"ep-close",render:function(e,t){return y(),x("svg",li,[...ii])}};const si=["element-loading-text"],oi={class:"image-box"},ri={class:"info-box"},ci={class:"image-info"},di={key:0,class:"rename-operate"},ui={key:1,class:"filename"},mi={class:"copy-link-box border-box"},gi={class:"operation-box"},pi={class:"operation-left"},hi={class:"operation-right"},fi={class:"operation-btn"};var vi=Ia(v({__name:"image-card",props:{imageObj:{type:Object,default:()=>({})},isUploaded:{type:Boolean,default:!1}},setup(e){const t=e,a=C(),l=ca(),i=se(),n=_((()=>l.getters.getUserConfigInfo)).value,s=_((()=>l.getters.getUserSettings)).value,c=_((()=>"/management"===i.path)),d=_((()=>Ht(t.imageObj,n,s))),u=O(),m=O(""),g=O(!1),h=O(!1),f=O(!1),v=(e,t=!1)=>{t||(e.deleting=!0);const{owner:i,selectedRepo:s}=n,{path:r,sha:c}=e;return new Promise((async n=>{var d,u;await pa(i,s,r,c)?(t?(g.value=!1,o.success({message:null==(d=null==a?void 0:a.proxy)?void 0:d.$t("management.message4")})):o.success({message:null==(u=null==a?void 0:a.proxy)?void 0:u.$t("management.message5")}),await l.dispatch("DIR_IMAGE_LIST_REMOVE",e),await l.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),n(!0)):n(!1)}))},b=async()=>{var e,i,c,h,f;const{imageObj:_}=t;if(!m.value)return o.error({message:null==(e=null==a?void 0:a.proxy)?void 0:e.$t("management.message1")}),void(null==(i=u.value)||i.focus());if(m.value===jt(_.name))return o.error({message:null==(c=null==a?void 0:a.proxy)?void 0:c.$t("management.message2")}),void(g.value=!1);const b=async()=>{var e,t,i;const c=r.service({lock:!0,text:null==(e=null==a?void 0:a.proxy)?void 0:e.$t("management.loadingTxt2")}),u=zt(_.name),p=$t(),h=`${m.value}${s.imageName.autoAddHash?`.${p}`:""}.${u}`;let f;var b;if(f=u.includes("svg")?await(b=d.value||"",new Promise((e=>{Fe({baseURL:"",url:b,method:"GET",responseType:"blob"}).then((t=>{if(t){const a=new FileReader;a.onload=()=>{const t=a.result;e(t)},a.onerror=()=>{e(null)},a.readAsDataURL(t)}else e(null)})).catch((()=>{e(null)}))}))):await function(e,t){const a=document.createElement("canvas"),l=a.getContext("2d"),i=new Image;return i.crossOrigin="Anonymous",i.src=e,new Promise((e=>{i.onload=()=>{const{width:n}=i,{height:s}=i;a.width=n,a.height=s,null==l||l.drawImage(i,0,0,n,s);const o=a.toDataURL(`image/${t}`);e(o)}}))}(d.value||"",u),f){const e={uuid:"",base64:{originalBase64:"",watermarkBase64:null,compressBase64:null},fileInfo:{originalFile:null,watermarkFile:null,compressFile:null},filename:{hash:"",suffix:"",name:"",prefixName:"",final:"",initName:"",newName:"",isAddHash:!0,isRename:!1,isPrefixNaming:!1,isTimestampNaming:!1},beforeUploadStatus:{watermarking:!1,compressing:!1},uploadStatus:{progress:0,uploading:!1},reUploadInfo:{dir:"",path:"",isReUpload:!1}};e.uuid=p,e.base64.originalBase64=f,e.filename.final=h,e.reUploadInfo.isReUpload=!0,e.reUploadInfo.dir=_.dir;let i=h;"/"!==_.dir&&(i=`${_.dir}/${h}`),e.reUploadInfo.path=i;await nl(n,e)?(m.value="",await v(_,!0),await l.dispatch("UPLOAD_IMG_LIST_REMOVE",_.uuid)):o.error({message:null==(t=null==a?void 0:a.proxy)?void 0:t.$t("management.message3")})}else o.error({message:null==(i=null==a?void 0:a.proxy)?void 0:i.$t("management.message3")});c.close(),g.value=!1};p.confirm(null==(h=null==a?void 0:a.proxy)?void 0:h.$t("management.renameTips",{name:m.value}),null==(f=null==a?void 0:a.proxy)?void 0:f.$t("tips"),{type:"info"}).then((()=>{b()})).catch((()=>{g.value=!1}))},k=e=>{f.value=e};return(t,i)=>{const n=ae,s=N,o=ni,r=U,_=rl,$=oe,C=ai,O=T,E=Yl,R=re,A=ce,M=de,P=B;return V((y(),x("div",{class:K(["image-card",{checked:e.imageObj.checked}]),"element-loading-text":t.$t("management.loadingTxt3"),onMouseenter:i[6]||(i[6]=e=>h.value=!0),onMouseleave:i[7]||(i[7]=e=>h.value=!1)},[S("div",oi,[L(n,{src:d.value,fit:"cover",loading:"lazy",lazy:"","hide-on-click-modal":!0,"preview-src-list":[d.value]},null,8,["src","preview-src-list"])]),S("div",ri,[S("div",ci,[g.value?(y(),x("div",di,[L(s,{size:"small",class:"rename-input",modelValue:m.value,"onUpdate:modelValue":i[0]||(i[0]=e=>m.value=e),clearable:"",ref_key:"renameInputRef",ref:u,maxlength:I(72)},null,8,["modelValue","maxlength"]),L($,{size:"small"},{default:D((()=>[L(r,{onClick:i[1]||(i[1]=e=>g.value=!1)},{default:D((()=>[L(o)])),_:1}),L(r,{onClick:H(b,["prevent"])},{default:D((()=>[L(_)])),_:1})])),_:1})])):(y(),x("div",ui,W(e.imageObj.name),1))])]),S("div",mi,[L(C,{"img-obj":e.imageObj},null,8,["img-obj"])]),V(S("div",gi,[S("div",pi,[c.value?(y(),x("div",{key:0,class:K([e.imageObj.checked?"picked-btn":"pick-btn","operation-btn"]),onClick:i[2]||(i[2]=t=>{return(a=e.imageObj).checked=!a.checked,void l.commit("IMAGE_CARD",{imageObj:a});var a})},[e.imageObj.checked?(y(),w(O,{key:0},{default:D((()=>[L(_)])),_:1})):F("",!0)],2)):F("",!0)]),S("div",hi,[L(M,{size:"default",trigger:"click",onVisibleChange:k},{dropdown:D((()=>[L(A,null,{default:D((()=>[L(R,{onClick:i[3]||(i[3]=t=>{return l=e.imageObj,void p.confirm(`\n    <div>${null==(i=null==a?void 0:a.proxy)?void 0:i.$t("management.delTips")}：</div>\n    <strong>${l.name}</strong>\n    `,null==(n=null==a?void 0:a.proxy)?void 0:n.$t("tips"),{dangerouslyUseHTMLString:!0,type:"warning"}).then((()=>{v(l)})).catch((()=>{}));var l,i,n})},{default:D((()=>[X(W(t.$t("upload.delete")),1)])),_:1}),L(R,{onClick:i[4]||(i[4]=H((t=>(async e=>{g.value=!0,m.value=jt(e.name),setTimeout((()=>{var e;null==(e=u.value)||e.focus()}),100)})(e.imageObj)),["self"]))},{default:D((()=>[X(W(t.$t("upload.rename")),1)])),_:1}),L(R,{onClick:i[5]||(i[5]=t=>{return l=e.imageObj,void p.confirm(`\n    <div>${null==(i=null==a?void 0:a.proxy)?void 0:i.$t("management.imageName")}：<strong>${l.name}</strong></div>\n    <div>${null==(n=null==a?void 0:a.proxy)?void 0:n.$t("management.imageSize")}：<strong>${Bt(l.size)} KB</strong></div>\n    `,null==(s=null==a?void 0:a.proxy)?void 0:s.$t("management.property"),{showCancelButton:!1,showConfirmButton:!1,dangerouslyUseHTMLString:!0,type:"info"});var l,i,n,s})},{default:D((()=>[X(W(t.$t("management.property")),1)])),_:1})])),_:1})])),default:D((()=>[S("div",fi,[L(O,null,{default:D((()=>[L(E)])),_:1})])])),_:1})])],512),[[ue,h.value||f.value||e.imageObj.checked]])],42,si)),[[P,e.imageObj.deleting]])}}}),[["__scopeId","data-v-04e21f80"]]);const _i=e=>(Z("data-v-6330fedd"),e=e(),ee(),e),bi=_i((()=>S("div",{class:"icon"},[S("svg",{t:"1639999626518",class:"icon",viewBox:"0 0 1228 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3575",width:"200",height:"200"},[S("path",{d:"M1196.987733 212.5824v540.0576c0 39.594667-34.474667 71.3728-76.765866 71.3728H323.242667c-51.780267 0-88.746667-46.762667-73.250134-92.808533l126.737067-375.808H70.417067C31.675733 355.362133 0 326.4512 0 291.089067V98.372267C0 63.044267 31.675733 34.0992 70.417067 34.0992h378.811733c26.7264 0 51.029333 13.9264 63.010133 35.703467l39.048534 71.406933H1120.256c42.257067 0 76.8 32.119467 76.8 71.3728",fill:"#5398DF","p-id":"3576"}),S("path",{d:"M1128.721067 997.853867H68.266667a68.266667 68.266667 0 0 1-68.266667-68.266667V280.3712a68.266667 68.266667 0 0 1 68.266667-68.266667h1060.4544a68.266667 68.266667 0 0 1 68.266666 68.266667V929.5872a68.266667 68.266667 0 0 1-68.266666 68.266667",fill:"#85BCFF","p-id":"3577"})])],-1))),yi={key:1,class:"text"},wi={key:2,class:"icon"},ki=[_i((()=>S("svg",{t:"1640264285200",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"29312",width:"200",height:"200"},[S("path",{d:"M426.666667 384V213.333333l-298.666667 298.666667 298.666667 298.666667v-174.933334c213.333333 0 362.666667 68.266667 469.333333 217.6-42.666667-213.333333-170.666667-426.666667-469.333333-469.333333z","p-id":"29313",fill:"#85BCFF"})],-1)))],Ii={key:3,class:"text"};var xi=Ia(v({__name:"folder-card",props:{folderObj:{type:Object,default:()=>{}},mode:{type:String,default:"dir"}},setup(e){const t=ca(),a=_((()=>t.getters.getUserConfigInfo)).value,l=e,i=()=>{const{folderObj:e,mode:i}=l;if("back"===i){const e=a.viewDir;if("/"===e)return;const t=e.split("/");1===t.length?a.viewDir="/":t.length>1&&(t.length-=1,a.viewDir=t.join("/"))}"dir"===i&&(a.viewDir=e.dirPath),t.dispatch("USER_CONFIG_INFO_PERSIST")};return(t,a)=>{const l=$;return y(),x("div",{class:"folder-card",onDblclick:i},["dir"===e.mode?(y(),w(l,{key:0,content:t.$t("management.toNextDir"),placement:"top"},{default:D((()=>[bi])),_:1},8,["content"])):F("",!0),"dir"===e.mode?(y(),x("div",yi,W(e.folderObj.dir),1)):F("",!0),"back"===e.mode?(y(),x("div",wi,ki)):F("",!0),"back"===e.mode?(y(),x("div",Ii,W(t.$t("management.back")),1)):F("",!0)],32)}}}),[["__scopeId","data-v-6330fedd"]]);const Si={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ti=[S("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"},null,-1)];var $i={name:"ep-delete",render:function(e,t){return y(),x("svg",Si,[...Ti])}};const Li={key:0,class:"selector-wrapper"},Di={class:"selector-left-box"},Ci={class:"item"},Oi={class:"selector-right-box"};var Ei=Ia(v({__name:"image-selector",props:{currentDirImageList:{type:Array,default:()=>[]}},emits:["update:initImageList"],setup(e){const t=e,a=ca(),l=O(!1),i=C(),n=_((()=>a.getters.getImageCardCheckedArr)),s=_((()=>a.getters.getUserConfigInfo)).value,r=_((()=>a.getters.getUserSettings)).value,c=_((()=>n.value.length||0));E((()=>c.value),(e=>{const a=t.currentDirImageList.length;l.value=e===a}));const d=()=>{Jt(n.value,s,r)},u=()=>{t.currentDirImageList.forEach((e=>{e.checked&&(e.checked=!1)}))},m=()=>{var e,t,a,l;(null==(e=n.value)?void 0:e.length)>0&&p.confirm(null==(a=null==i?void 0:i.proxy)?void 0:a.$t("management.delTips2",{total:null==(t=n.value)?void 0:t.length}),null==(l=null==i?void 0:i.proxy)?void 0:l.$t("tips"),{type:"warning"}).then((async()=>{var e,t,a;const l=await Ut(n.value,s);l===at.deleted&&o.success({message:null==(e=null==i?void 0:i.proxy)?void 0:e.$t("management.message5")}),l===at.allDeleted&&o.success({message:null==(t=null==i?void 0:i.proxy)?void 0:t.$t("management.message6")}),l===at.deleteFail&&o.error({message:null==(a=null==i?void 0:i.proxy)?void 0:a.$t("management.message7")})})).catch((()=>{}))},g=()=>{let e=[];t.currentDirImageList.forEach((e=>{e.checked=l.value})),e=t.currentDirImageList,a.commit("REPLACE_IMAGE_CARD",{checkedImgArr:e})};return R((()=>{g()})),(e,t)=>{const a=le,i=ei,n=T,s=$,o=$i;return c.value?(y(),x("div",Li,[S("div",Di,[L(a,{label:l.value?e.$t("management.deselectAll"):e.$t("management.selectAll"),modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),onChange:g},null,8,["label","modelValue"]),S("div",Ci,W(e.$t("management.selectTotal",{total:c.value})),1),S("div",{class:"item cancel-select-btn",onClick:u},W(e.$t("management.unselect")),1)]),S("div",Oi,[L(s,{placement:"top",content:e.$t("management.batchCopy")},{default:D((()=>[L(n,{class:"btn-icon",onClick:d},{default:D((()=>[L(i)])),_:1})])),_:1},8,["content"]),L(s,{placement:"top",content:e.$t("management.batchDelete")},{default:D((()=>[L(n,{class:"btn-icon",onClick:m},{default:D((()=>[L(o)])),_:1})])),_:1},8,["content"])])])):F("",!0)}}}),[["__scopeId","data-v-12c07cc1"]]);const Ri={class:"page-container management-page-container"},Ni={class:"content-container"},Ai={class:"top"},Ui={class:"left"},Mi={class:"right flex-start"},Pi=["element-loading-text"],ji={key:0,class:"image-management-item"},zi=(e=>(Z("data-v-5e7dddc4"),e=e(),ee(),e))((()=>S("div",{style:{width:"100%"}},null,-1)));var Gi=Ia(v({__name:"imgs-management",setup(e){const t=ca(),a=ie(),l=_((()=>t.getters.getUserConfigInfo)).value,i=_((()=>t.getters.getUserLoginStatus)).value,n=_((()=>t.getters.getDirObject)).value,s=O((new Date).getTime()),o=O(!1),r=O([]),c=O([]),d=O(!1);async function u(e){o.value=!0;const a=Ye(e,n);if(a){const i=Qe(0,a,"dir"),n=Qe(0,a,"image");i.length||n.length?(r.value=i,c.value=n,t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:c.value})):await ua(l,e)}else await ua(l,e);o.value=!1}async function m(){const{viewDir:e}=l;await t.dispatch("DIR_IMAGE_LIST_INIT_DIR",e),o.value=!0,await ua(l,e),o.value=!1}return R((()=>{!async function(){const{selectedDir:e,viewDir:t,dirMode:a}=l;""===t&&(a!==dt.newDir&&a!==dt.autoDir||Ye(e,n)||(l.selectedDir="/",l.dirMode="rootDir"),l.selectedDir?l.viewDir=l.selectedDir:l.viewDir="/"),n.imageList.length||n.childrenDirs.length?await u(l.viewDir):await ua(l,l.viewDir)}()})),E((()=>i),(e=>{!1===e&&a.push("/config")})),E((()=>l.viewDir),(async e=>{await u(e),s.value+=1}),{deep:!0}),E((()=>n),(e=>{const{viewDir:a}=l,i=Ye(a,e);i&&(r.value=Qe(0,i,"dir"),c.value=Qe(0,i,"image"),t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:c.value}))}),{deep:!0}),E((()=>c.value),(e=>{d.value=e.filter((e=>e.checked)).length>0}),{deep:!0}),(e,t)=>{const a=ka,i=T,n=$,u=me("contextmenu"),g=B;return y(),x("div",Ri,[S("div",Ni,[S("div",Ai,[S("div",Ui,[L(Wa,{"bar-type":"management"})]),S("div",Mi,[L(n,{placement:"top",content:e.$t("management.reload",{dir:I(l).viewDir})},{default:D((()=>[L(i,{class:"btn-icon",onClick:H(m,["stop"])},{default:D((()=>[L(a)])),_:1})])),_:1},8,["content"])])]),V((y(),x("div",{class:"bottom","element-loading-text":e.$t("management.loadingTxt1")},[c.value.length?(y(),w(Ei,{currentDirImageList:c.value,"onUpdate:initImageList":c.value,key:s.value},null,8,["currentDirImageList","onUpdate:initImageList"])):F("",!0),V((y(),x("ul",{class:"image-management-list",style:k({height:d.value?"calc(100% - 50rem)":"100%"})},["/"!==I(l).viewDir?(y(),x("li",ji,[L(xi,{mode:"back"})])):F("",!0),(y(!0),x(q,null,J(r.value,((e,t)=>V((y(),x("li",{class:"image-management-item",key:"folder-card-"+e.dir+"-"+t},[L(xi,{"folder-obj":e},null,8,["folder-obj"])])),[[u,{type:I(yt).childDir,dir:e.dir}]]))),128)),zi,(y(!0),x(q,null,J(c.value,((e,t)=>V((y(),x("li",{class:"image-management-item image",key:"image-card-"+t},[L(vi,{"image-obj":e},null,8,["image-obj"])])),[[u,{type:I(yt).img,img:e}]]))),128))],4)),[[u,{type:I(yt).parentDir}]])],8,Pi)),[[g,o.value]])])])}}}),[["__scopeId","data-v-5e7dddc4"]]);const Bi={class:"card-header"},Vi=["onFocusout"],Fi={style:{"margin-top":"20px"}};var Hi=Ia(v({__name:"image-link-rule-config",setup(e){const t=C(),a=_((()=>oa.getters.getUserSettings)).value,l=_((()=>{const e=[];for(const t in a.imageLinkType.presetList)e.push(a.imageLinkType.presetList[t]);return e})),i=O(),n=te({id:"",name:"",rule:"",editable:!0});return(e,a)=>{const s=ge,o=$i,r=U,c=pe,d=he,u=N,m=A,g=M,h=fe;return y(),w(h,null,{header:D((()=>[S("div",Bi,[S("span",null,W(e.$t("settings.link_rule.card_title")),1)])])),default:D((()=>[L(c,{data:l.value,style:{width:"100%"}},{default:D((()=>[L(s,{prop:"name",label:e.$t("settings.link_rule.card_table_col_title_1"),width:"120"},null,8,["label"]),L(s,{label:e.$t("settings.link_rule.card_table_col_title_2")},{default:D((e=>[S("div",{contenteditable:!0,onFocusout:a=>((e,a)=>{var l;const i=JSON.parse(JSON.stringify(a));i.rule=e,oa.dispatch("UPDATE_IMAGE_LINK_TYPE_RULE",{rule:i,$t:null==(l=null==t?void 0:t.proxy)?void 0:l.$t})})(a.target.innerHTML,e.row)},W(e.row.rule),41,Vi)])),_:1},8,["label"]),L(s,{label:e.$t("settings.link_rule.card_table_col_title_3"),width:"80",align:"center"},{default:D((e=>[L(r,{link:"",size:"small",disabled:!e.row.editable,onClick:a=>{return l=e.row,void p.confirm(`${null==(i=null==t?void 0:t.proxy)?void 0:i.$t("settings.link_format.delete_tips")}：<strong>${l.name}</strong>`,null==(n=null==t?void 0:t.proxy)?void 0:n.$t("tips"),{dangerouslyUseHTMLString:!0,type:"warning"}).then((()=>{oa.dispatch("DEL_IMAGE_LINK_TYPE_RULE",l)})).catch((()=>{}));var l,i,n}},{default:D((()=>[L(o)])),_:2},1032,["disabled","onClick"])])),_:1},8,["label"])])),_:1},8,["data"]),L(d),S("div",Fi,[L(g,{ref_key:"formRef",ref:i,"label-position":"left",model:n,"label-width":"120px",size:"default"},{default:D((()=>[L(m,{label:e.$t("settings.link_rule.input_name_1"),prop:"name",rules:[{required:!0,message:e.$t("settings.link_rule.input_name_1_rule")}]},{default:D((()=>[L(u,{modelValue:n.name,"onUpdate:modelValue":a[0]||(a[0]=e=>n.name=e),type:"text"},null,8,["modelValue"])])),_:1},8,["label","rules"]),L(m,{label:e.$t("settings.link_rule.input_name_2"),prop:"rule",rules:[{required:!0,message:e.$t("settings.link_rule.input_name_2_rule")}]},{default:D((()=>[L(u,{modelValue:n.rule,"onUpdate:modelValue":a[1]||(a[1]=e=>n.rule=e),type:"text"},null,8,["modelValue"])])),_:1},8,["label","rules"]),L(m,null,{default:D((()=>[L(r,{type:"primary",disabled:!n.name||!n.rule,onClick:a[2]||(a[2]=e=>{var a;(a=i.value)&&a.validate((e=>{var a;e&&(n.id=$t(),oa.dispatch("ADD_IMAGE_LINK_TYPE_RULE",{rule:JSON.parse(JSON.stringify(n)),$t:null==(a=null==t?void 0:t.proxy)?void 0:a.$t}))}))})},{default:D((()=>[X(W(e.$t("settings.link_rule.btn_name_1")),1)])),_:1},8,["disabled"])])),_:1})])),_:1},8,["model"])])])),_:1})}}}),[["__scopeId","data-v-d95bf426"]]);const Xi={class:"compress-config-box"},Wi={class:"img-encoder-title"},qi={class:"desc"},Ji={class:"desc"},Ki={class:"desc"};var Yi=Ia(v({__name:"compress-config-box",props:{disabled:{type:Boolean,default:!1},usageScenario:{type:String,default:"toolbox"}},emits:["encoder"],setup(e,{expose:t,emit:a}){const l=_((()=>oa.getters.getUserSettings)).value,i=O(it.webP),n=a,s=e,o=e=>{n("encoder",e)};return R((()=>{"imageHosting"===s.usageScenario&&(i.value=l.compress.encoder),n("encoder",i.value)})),t({reset:()=>{i.value=it.webP}}),(t,a)=>{const l=z,n=G;return y(),x("div",Xi,[S("div",Wi,W(t.$t("settings.img_compress.radio_group_title")),1),L(n,{disabled:e.disabled,class:"img-encoder-group",modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),onChange:o},{default:D((()=>[L(l,{label:I(it).webP},{default:D((()=>[X(W(I(it).webP)+" ",1),S("span",qi,W(t.$t("settings.img_compress.radio_1_desc")),1)])),_:1},8,["label"]),L(l,{label:I(it).mozJPEG},{default:D((()=>[X(W(I(it).mozJPEG)+" ",1),S("span",Ji,W(t.$t("settings.img_compress.radio_2_desc")),1)])),_:1},8,["label"]),L(l,{label:I(it).avif},{default:D((()=>[X(W(I(it).avif)+" ",1),S("span",Ki,W(t.$t("settings.img_compress.radio_3_desc")),1)])),_:1},8,["label"])])),_:1},8,["disabled","modelValue"])])}}}),[["__scopeId","data-v-0083dd6b"]]);const Qi=v({__name:"watermark-config-box",props:{isTool:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["watermarkConfig"],setup(e,{emit:t}){const a=te({text:"",fontSize:0,position:pt.rightBottom,textColor:"",opacity:0}),l=t,i=()=>{l("watermarkConfig",a)};return R((()=>{const e=oa.getters.getUserSettings.watermark;a.text=e.text,a.textColor=e.textColor,a.fontSize=e.fontSize,a.position=e.position,a.opacity=e.opacity,l("watermarkConfig",a)})),(t,l)=>{const n=N,s=A,o=ve,r=_e,c=be,d=z,u=G,m=ye,g=M;return y(),w(g,{class:"watermark-config-form","label-position":"left","label-width":"90rem",disabled:e.disabled},{default:D((()=>[L(m,null,{default:D((()=>[L(o,{span:24},{default:D((()=>[L(s,{label:t.$t("settings.img_watermark.text")},{default:D((()=>[L(n,{modelValue:a.text,"onUpdate:modelValue":l[0]||(l[0]=e=>a.text=e),placeholder:t.$t("settings.img_watermark.text_input_placeholder"),clearable:"",maxlength:"20",onInput:i},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),L(o,{span:e.isTool?10:24},{default:D((()=>[L(s,{label:t.$t("settings.img_watermark.size")},{default:D((()=>[L(r,{modelValue:a.fontSize,"onUpdate:modelValue":l[1]||(l[1]=e=>a.fontSize=e),min:40,max:80,step:2,onChange:i},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"]),L(o,{span:e.isTool?14:24},{default:D((()=>[L(s,{label:t.$t("settings.img_watermark.color")},{default:D((()=>[L(c,{modelValue:a.textColor,"onUpdate:modelValue":l[2]||(l[2]=e=>a.textColor=e),onChange:i},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"]),L(o,{span:e.isTool?10:24},{default:D((()=>[L(s,{label:t.$t("settings.img_watermark.opacity")},{default:D((()=>[L(r,{modelValue:a.opacity,"onUpdate:modelValue":l[3]||(l[3]=e=>a.opacity=e),precision:1,step:.1,min:.1,max:.9,onChange:i},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"]),L(o,{span:e.isTool?14:24},{default:D((()=>[L(s,{label:t.$t("settings.img_watermark.position")},{default:D((()=>[L(u,{modelValue:a.position,"onUpdate:modelValue":l[4]||(l[4]=e=>a.position=e),onChange:i},{default:D((()=>[L(d,{label:I(pt).leftTop},{default:D((()=>[X(W(t.$t("settings.img_watermark.position_1")),1)])),_:1},8,["label"]),L(d,{label:I(pt).leftBottom},{default:D((()=>[X(W(t.$t("settings.img_watermark.position_2")),1)])),_:1},8,["label"]),L(d,{label:I(pt).rightTop},{default:D((()=>[X(W(t.$t("settings.img_watermark.position_3")),1)])),_:1},8,["label"]),L(d,{label:I(pt).rightBottom},{default:D((()=>[X(W(t.$t("settings.img_watermark.position_4")),1)])),_:1},8,["label"])])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"])])),_:1})])),_:1},8,["disabled"])}}});var Zi,en;(en=Zi||(Zi={}))[en.save=0]="save",en[en.use=1]="use",en[en.update=2]="update",en[en.equal=3]="equal";const tn=async e=>{const{owner:t,selectedRepo:a}=e,l=await Fe({url:`/repos/${t}/${a}/contents/.settings`,method:"GET",noShowErrorMsg:!0,cache:{maxAge:0},params:{timestamp:Date.now()}});return Promise.resolve(l)};const an={class:"cloud-settings-data-box border-box"};var ln=Ia(v({__name:"cloud-settings-bar",setup(e){const t=C(),a=_((()=>oa.getters.getUserSettings)).value,l=_((()=>oa.getters.getUserConfigInfo)).value,i=we({IEpCheck:rl,IEpClose:ni}),n=O(null),s=O(!1),r=O(!1),c=O(Zi.save),d=_((()=>{var e,a,l,i,n;switch(c.value){case Zi.save:return null==(e=null==t?void 0:t.proxy)?void 0:e.$t("settings.cloud_settings.tip_1");case Zi.use:return null==(a=null==t?void 0:t.proxy)?void 0:a.$t("settings.cloud_settings.tip_2");case Zi.update:return null==(l=null==t?void 0:t.proxy)?void 0:l.$t("settings.cloud_settings.tip_3");case Zi.equal:return null==(i=null==t?void 0:t.proxy)?void 0:i.$t("settings.cloud_settings.tip_4");default:return null==(n=null==t?void 0:t.proxy)?void 0:n.$t("settings.cloud_settings.tip_1")}})),u=async()=>{var e,i;s.value=!0,await(async(e,t)=>{const{owner:a,selectedRepo:l,selectedBranch:i}=t,n=await tn(t),s={message:n?"update settings":"init settings",content:window.btoa(JSON.stringify(e))};n?s.sha=n.sha:s.branch=i;const o=await Fe({url:`/repos/${a}/${l}/contents/.settings`,method:"PUT",data:s,noShowErrorMsg:!0});return Promise.resolve(o)})(a,l),s.value=!1,n.value=JSON.parse(JSON.stringify(a)),o.success(null===n.value?null==(e=null==t?void 0:t.proxy)?void 0:e.$t("settings.cloud_settings.success_msg_1"):null==(i=null==t?void 0:t.proxy)?void 0:i.$t("settings.cloud_settings.success_msg_2"))},m=()=>{switch(c.value){case Zi.save:case Zi.update:u();break;case Zi.use:n.value&&(Ct(a,n.value),oa.dispatch("USER_SETTINGS_PERSIST"))}};return E((()=>a),(e=>{Rt(e,n.value)?(c.value=Zi.equal,r.value=!0):(c.value=Zi.update,r.value=!1)}),{deep:!0}),E((()=>n.value),(e=>{null===e&&(c.value=Zi.save),e&&(c.value=Zi.use),e&&Rt(e,a)?(r.value=!0,c.value=Zi.equal):(r.value=!1,c.value=Zi.update)}),{deep:!0}),R((()=>{(async()=>{const e=await tn(l);n.value=e?JSON.parse(window.atob(e.content)):null})()})),(e,t)=>{const a=U;return y(),x("div",an,[S("div",null,W(d.value),1),L(a,{type:"primary",text:"",icon:i.value.IEpCheck,loading:s.value,disabled:r.value,onClick:m},{default:D((()=>[X(W(e.$t("confirm")),1)])),_:1},8,["icon","loading","disabled"])])}}}),[["__scopeId","data-v-5ccf2114"]]);const nn={class:"page-container settings-page-container"},sn={class:"setting-list",style:{"margin-top":"10rem"}},on={class:"setting-item has-desc"},rn={class:"desc"},cn={class:"setting-item has-desc"},dn={class:"desc"},un={key:0,class:"setting-item has-desc"},mn={class:"setting-item has-desc"},gn={class:"setting-list"},pn={class:"setting-item has-desc"},hn={class:"desc"},fn={class:"setting-item"},vn={class:"setting-list"},_n={class:"setting-item has-desc"},bn={class:"desc"},yn={class:"setting-item"},wn={class:"setting-list"},kn={class:"setting-item cdn"},In={class:"left"},xn={class:"right"},Sn={class:"setting-item",style:{"margin-top":"20rem"}},Tn={class:"setting-list"},$n={class:"setting-item has-desc"},Ln={class:"desc"},Dn={class:"setting-item"},Cn={class:"left"},On={class:"right"},En={class:"setting-list"},Rn={class:"setting-item"};var Nn=Ia(v({__name:"my-settings",setup(e){const t=_((()=>oa.getters.getUserSettings)).value,a=()=>{oa.dispatch("USER_SETTINGS_PERSIST")},l=()=>{oa.dispatch("SET_USER_SETTINGS",n({},t))},i=e=>{t.watermark.text=e.text,t.watermark.textColor=e.textColor,t.watermark.opacity=e.opacity,t.watermark.position=e.position,t.watermark.fontSize=e.fontSize,a()};return E((()=>t.imageName.autoTimestampNaming),(e=>{e?(t.imageName.autoAddHash=!1,t.imageName.prefixNaming.enable=!1):t.imageName.autoAddHash=!0,a()}),{immediate:!0,deep:!0}),(e,n)=>{const s=ln,o=ke,r=N,c=Ie,d=Qi,u=fe,m=Yi,g=P,p=j,h=Hi,f=Ba,v=xe;return y(),x("div",nn,[L(s,{style:{"margin-bottom":"20rem"}}),L(v,null,{default:D((()=>[L(c,{title:e.$t("settings.img_name.title"),name:"1"},{default:D((()=>[S("ul",sn,[S("li",on,[L(o,{modelValue:I(t).imageName.autoAddHash,"onUpdate:modelValue":n[0]||(n[0]=e=>I(t).imageName.autoAddHash=e),onChange:a,"active-text":e.$t("settings.img_name.hash_switch_name")},null,8,["modelValue","active-text"]),S("span",rn,W(e.$t("settings.img_name.hash_switch_desc")),1)]),S("li",cn,[L(o,{modelValue:I(t).imageName.prefixNaming.enable,"onUpdate:modelValue":n[1]||(n[1]=e=>I(t).imageName.prefixNaming.enable=e),onChange:a,"active-text":e.$t("settings.img_name.prefix_switch_name")},null,8,["modelValue","active-text"]),S("span",dn,W(e.$t("settings.img_name.prefix_switch_desc")),1)]),I(t).imageName.prefixNaming.enable?(y(),x("li",un,[L(r,{class:"prefix-input",modelValue:I(t).imageName.prefixNaming.prefix,"onUpdate:modelValue":n[2]||(n[2]=e=>I(t).imageName.prefixNaming.prefix=e),placeholder:e.$t("settings.img_name.prefix_input_placeholder"),onInput:a,clearable:"",autofocus:""},null,8,["modelValue","placeholder"])])):F("",!0),S("li",mn,[L(o,{modelValue:I(t).imageName.autoTimestampNaming,"onUpdate:modelValue":n[3]||(n[3]=e=>I(t).imageName.autoTimestampNaming=e),onChange:a,"active-text":e.$t("settings.img_name.timestamp_switch_name")},null,8,["modelValue","active-text"])])])])),_:1},8,["title"]),L(c,{title:e.$t("settings.img_watermark.title"),name:"2"},{default:D((()=>[S("ul",gn,[S("li",pn,[L(o,{modelValue:I(t).watermark.enable,"onUpdate:modelValue":n[4]||(n[4]=e=>I(t).watermark.enable=e),onChange:a,"active-text":e.$t("settings.img_watermark.switch_name")},null,8,["modelValue","active-text"]),S("span",hn,W(e.$t("settings.img_watermark.switch_desc")),1)]),S("li",fn,[L(u,{class:"settings-item-card"},{default:D((()=>[L(d,{disabled:!I(t).watermark.enable,onWatermarkConfig:i},null,8,["disabled"])])),_:1})])])])),_:1},8,["title"]),L(c,{title:e.$t("settings.img_compress.title"),name:"3"},{default:D((()=>[S("ul",vn,[S("li",_n,[L(o,{modelValue:I(t).compress.enable,"onUpdate:modelValue":n[5]||(n[5]=e=>I(t).compress.enable=e),onChange:a,"active-text":e.$t("settings.img_compress.switch_name")},null,8,["modelValue","active-text"]),S("span",bn,W(e.$t("settings.img_compress.switch_desc")),1)]),S("li",yn,[L(u,{class:"settings-item-card"},{default:D((()=>[L(m,{ref:"compressConfigBoxRef","usage-scenario":"imageHosting",disabled:!I(t).compress.enable,onEncoder:n[6]||(n[6]=e=>{I(t).compress.encoder=e,a()})},null,8,["disabled"])])),_:1})])])])),_:1},8,["title"]),L(c,{title:e.$t("settings.link_rule.title"),name:"4"},{default:D((()=>[S("ul",wn,[S("li",kn,[X(W(e.$t("settings.link_rule.select_title"))+"： ",1),L(p,{modelValue:I(t).imageLinkType.selected,"onUpdate:modelValue":n[7]||(n[7]=e=>I(t).imageLinkType.selected=e),onChange:l},{default:D((()=>[(y(!0),x(q,null,J(I(t).imageLinkType.presetList,(e=>(y(),w(g,{key:e.name+"-"+e.id,label:e.name,value:e.name,class:"image-link-type-rule-option"},{default:D((()=>[S("span",In,W(e.name),1),S("span",xn,W(e.rule),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])]),S("li",Sn,[L(h)])])])),_:1},8,["title"]),L(c,{title:e.$t("settings.link_format.title"),name:"5"},{default:D((()=>[S("ul",Tn,[S("li",$n,[L(o,{modelValue:I(t).imageLinkFormat.enable,"onUpdate:modelValue":n[8]||(n[8]=e=>I(t).imageLinkFormat.enable=e),onChange:a,"active-text":e.$t("settings.link_format.switch_name")},null,8,["modelValue","active-text"]),S("span",Ln,W(e.$t("settings.link_format.switch_desc",{type:I(t).imageLinkFormat.selected})),1)]),S("li",Dn,[X(W(e.$t("settings.link_format.select_title"))+"： ",1),L(p,{modelValue:I(t).imageLinkFormat.selected,"onUpdate:modelValue":n[9]||(n[9]=e=>I(t).imageLinkFormat.selected=e),onChange:l},{default:D((()=>[(y(!0),x(q,null,J(I(t).imageLinkFormat.presetList,((e,t)=>(y(),w(g,{key:t+e.name,label:e.name,value:e.name,class:"image-link-type-rule-option"},{default:D((()=>[S("span",Cn,W(e.name),1),S("span",On,W(e.format),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1},8,["title"]),L(c,{title:e.$t("settings.image_hosting_deploy.title"),name:"6"},{default:D((()=>[L(f)])),_:1},8,["title"]),L(c,{title:e.$t("settings.theme.title"),name:"7"},{default:D((()=>[S("ul",En,[S("li",Rn,[X(W(e.$t("header.theme"))+"： ",1),L(p,{modelValue:I(t).theme.mode,"onUpdate:modelValue":n[10]||(n[10]=e=>I(t).theme.mode=e),onChange:l},{default:D((()=>[L(g,{label:e.$t("settings.theme.system"),value:I(ft).system},null,8,["label","value"]),L(g,{label:e.$t("settings.theme.light"),value:I(ft).light},null,8,["label","value"]),L(g,{label:e.$t("settings.theme.dark"),value:I(ft).dark},null,8,["label","value"])])),_:1},8,["modelValue"])])])])),_:1},8,["title"])])),_:1})])}}}),[["__scopeId","data-v-0ea85421"]]);const An={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Un=[S("path",{fill:"currentColor",d:"M512 64h64v192h-64zm0 576h64v192h-64zM160 480v-64h192v64zm576 0v-64h192v64zM249.856 199.04l45.248-45.184L430.848 289.6L385.6 334.848L249.856 199.104zM657.152 606.4l45.248-45.248l135.744 135.744l-45.248 45.248zM114.048 923.2L68.8 877.952l316.8-316.8l45.248 45.248zM702.4 334.848L657.152 289.6l135.744-135.744l45.248 45.248z"},null,-1)];var Mn={name:"ep-magic-stick",render:function(e,t){return y(),x("svg",An,[...Un])}};const Pn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},jn=[S("path",{fill:"currentColor",d:"M602.496 240.448A192 192 0 1 1 874.048 512l-316.8 316.8A256 256 0 0 1 195.2 466.752L602.496 59.456l45.248 45.248L240.448 512A192 192 0 0 0 512 783.552l316.8-316.8a128 128 0 1 0-181.056-181.056L353.6 579.904a32 32 0 1 0 45.248 45.248l294.144-294.144l45.312 45.248L444.096 670.4a96 96 0 1 1-135.744-135.744l294.144-294.208z"},null,-1)];var zn={name:"ep-paperclip",render:function(e,t){return y(),x("svg",Pn,[...jn])}};const Gn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Bn=[S("path",{fill:"currentColor",d:"M160 224a32 32 0 0 0-32 32v512a32 32 0 0 0 32 32h704a32 32 0 0 0 32-32V256a32 32 0 0 0-32-32zm0-64h704a96 96 0 0 1 96 96v512a96 96 0 0 1-96 96H160a96 96 0 0 1-96-96V256a96 96 0 0 1 96-96"},null,-1),S("path",{fill:"currentColor",d:"M704 320a64 64 0 1 1 0 128a64 64 0 0 1 0-128M288 448h256q32 0 32 32t-32 32H288q-32 0-32-32t32-32m0 128h256q32 0 32 32t-32 32H288q-32 0-32-32t32-32"},null,-1)];var Vn={name:"ep-postcard",render:function(e,t){return y(),x("svg",Gn,[...Bn])}};const Fn=we([{name:"toolbox.tool_1",desc:"toolbox.tool_1_desc",icon:Mn,uuid:$t(),path:"/compress"},{name:"toolbox.tool_2",desc:"toolbox.tool_2_desc",icon:zn,uuid:$t(),path:"/base64"},{name:"toolbox.tool_3",desc:"toolbox.tool_3_desc",icon:Vn,uuid:$t(),path:"/watermark"}]);const Hn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Xn=[S("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512L340.864 831.872a30.592 30.592 0 0 0 0 42.752a29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"},null,-1)];var Wn={name:"ep-arrow-right",render:function(e,t){return y(),x("svg",Hn,[...Xn])}};const qn={class:"page-container"},Jn={key:0,class:"tool-panel"},Kn={class:"panel-header"},Yn={class:"panel-body"},Qn={key:1,class:"toolbox"},Zn=["onClick"],es={class:"top"},ts={class:"left flex-center"},as={class:"right"},ls={class:"bottom"};var is=Ia(v({__name:"picx-toolbox",setup(e){const t=we(Wn),a=ie(),l=O("/toolbox"),i=O(!1),s=O({path:"",icon:"",name:"",desc:"",uuid:""}),o=e=>{i.value=!0,s.value=n({},e),oa.dispatch("TOOLBOX_IMG_LIST_RESET"),a.push(`${l.value}${e.path}`)};E((()=>a.currentRoute.value),(e=>{e.path===l.value&&(i.value=!1)}),{deep:!0});return R((()=>{a.isReady().then((()=>{const e=a.currentRoute.value.path;if(l.value!==e){const t=e.substring(e.lastIndexOf("/")),a=Fn.value.find((e=>e.path===t));a&&o(a)}}))})),(e,a)=>{const n=Se,r=Te,c=$e("router-view"),d=T;return y(),x("div",qn,[i.value?(y(),x("div",Jn,[S("div",Kn,[L(r,{"separator-icon":t.value},{default:D((()=>[L(n,{to:{path:l.value}},{default:D((()=>[X(W(e.$t("nav.toolbox")),1)])),_:1},8,["to"]),L(n,null,{default:D((()=>[X(W(e.$t(s.value.name)),1)])),_:1})])),_:1},8,["separator-icon"])]),S("div",Yn,[L(c)])])):(y(),x("ul",Qn,[(y(!0),x(q,null,J(I(Fn),(t=>(y(),x("li",{class:"tool-item",key:t.uuid,onClick:e=>o(t)},[S("div",es,[S("div",ts,[L(d,{size:30},{default:D((()=>[(y(),w(Le(t.icon)))])),_:2},1024)]),S("div",as,W(e.$t(t.name)),1)]),S("div",ls,W(e.$t(t.desc)),1)],8,Zn)))),128))]))])}}}),[["__scopeId","data-v-9a919de0"]]);const ns={class:"page-container feedback-page-container"},ss={class:"help-info-item description"},os={class:"help-info-item"},rs={class:"help-info-item"},cs={class:"help-info-item"},ds={class:"help-info-item"},us={class:"help-info-item",style:{"margin-bottom":"2rem"}},ms={class:"help-info-item img"},gs={class:"help-info-item red-text"};var ps=Ia(v({__name:"feedback-info",setup(e){const t=_((()=>"win"===Kt()?"Ctrl + D":"Command + D"));return(e,a)=>{const l=De,i=ae;return y(),x("div",ns,[S("div",ss,"🏞️ "+W(e.$t("feedback.text_1")),1),S("div",os,[X(" 🌍 "+W(e.$t("feedback.text_2"))+" "+W(e.$t("shortcut_key"))+"：",1),S("code",null,W(t.value),1)]),S("div",rs,[X(" 🦁 "+W(e.$t("author"))+"： ",1),L(l,{type:"primary",href:"https://xpoet.cn/",target:"_blank"},{default:D((()=>[X("@XPoet")])),_:1})]),S("div",cs,[X(" 🌀 "+W(e.$t("repo"))+"： ",1),L(l,{type:"primary",href:"https://github.com/XPoet/picx",target:"_blank"},{default:D((()=>[X(" https://github.com/XPoet/picx ")])),_:1})]),S("div",ds,[X(" 📖 "+W(e.$t("document"))+"： ",1),L(l,{type:"primary",href:"https://picx-docs.xpoet.cn",target:"_blank"},{default:D((()=>[X(" https://picx-docs.xpoet.cn ")])),_:1})]),S("div",us,"🎁 "+W(e.$t("feedback.text_3")),1),S("div",ms,[L(i,{style:{width:"300rem"},src:"https://xpoet.cn/images/admire-code-wechat.webp"})]),S("div",gs,[S("strong",null," ⚠️ "+W(e.$t("feedback.text_4")),1)])])}}}),[["__scopeId","data-v-5b1bf157"]]);const hs={class:"img-process-state-card-container"},fs={class:"img-container"},vs={class:"info-container"},_s={class:"img-name text-ellipsis"},bs={class:"img-size"},ys={key:0,class:"finial-file-size file-size-item"};var ws=Ia(v({__name:"img-process-state-card",props:{imgObj:{type:Object,require:!0,default:()=>({})},cardType:{type:String,default:"compress"}},emits:["remove"],setup(e,{emit:t}){const a=t;return(t,l)=>{const i=ae,n=pl,s=T,r=$,c=B;return y(),x("div",hs,[V((y(),x("div",fs,[L(i,{src:e.imgObj.finialBase64||e.imgObj.originalBase64,fit:"cover",loading:"lazy","hide-on-click-modal":!0,"preview-src-list":[e.imgObj.finialBase64||e.imgObj.originalBase64]},null,8,["src","preview-src-list"])])),[[c,e.imgObj.processing]]),S("div",vs,[S("div",_s,W(e.imgObj.finialName||e.imgObj.originalName),1),S("div",bs,[S("div",{class:K(["original-file-size file-size-item",{"del-line":e.imgObj.finialSize&&"compress"===e.cardType}])},W(I(Bt)(e.imgObj.originalSize))+" KB ",3),e.imgObj.finialSize&&"compress"===e.cardType?(y(),x("div",ys,W(I(Bt)(e.imgObj.finialSize))+" KB ",1)):F("",!0)])]),e.imgObj.finialFile?(y(),x("div",{key:0,class:"operate-container flex-center",onClick:l[0]||(l[0]=t=>{Pt(e.imgObj.finialFile)})},W(t.$t("toolbox.click_download")),1)):F("",!0),"base64"===e.cardType&&e.imgObj.originalBase64?(y(),x("div",{key:1,class:"operate-container flex-center",onClick:l[1]||(l[1]=a=>{return l=e.imgObj.originalBase64,i=t.$t,void Lt(l,(()=>{o.success({message:i("toolbox.copy_base64_success")})}));var l,i})},W(t.$t("toolbox.copy_base64")),1)):F("",!0),L(r,{placement:"top",offset:8,content:t.$t("delete")},{default:D((()=>[L(s,{class:"del-btn",onClick:l[2]||(l[2]=t=>{return l=e.imgObj.uuid,void a("remove",l);var l})},{default:D((()=>[L(n)])),_:1})])),_:1},8,["content"])])}}}),[["__scopeId","data-v-d82eed28"]]);const ks={class:"compress-tool-container"},Is={key:0,class:"compress-tool-left"};var xs=Ia(v({__name:"compress-tool",setup(e){const t=ca(),a=O(null),l=O(null),i=O([]),n=O(it.webP),s=O(!1),o=O(!1),r=e=>{o.value=!1,s.value=!1,e.forEach((e=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:e.uuid,originalName:e.file.name,originalSize:e.file.size,originalBase64:e.base64,originalFile:e.file})}))},c=()=>{var e,i;t.dispatch("TOOLBOX_IMG_LIST_RESET"),o.value=!1,null==(e=a.value)||e.reset(),null==(i=l.value)||i.reset()},d=async()=>{s.value=!0;for(const e of i.value)e.processing=!0,e.finialFile=await Ft(e.originalFile,n.value),e.finialBase64=await Mt(e.finialFile)||"",e.finialSize=e.finialFile.size,e.finialName=e.finialFile.name,e.processing=!1;o.value=!0,s.value=!1},u=async()=>{const e=new Ce;i.value.forEach((t=>{const a=t.finialFile;e.file(a.name,a)}));const t=Date.now();e.generateAsync({type:"blob"}).then((e=>{const a=URL.createObjectURL(e),l=document.createElement("a");l.href=a,l.download=`images_${t}.zip`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)}))},m=e=>{var l;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",e),null==(l=a.value)||l.remove(e)};return E((()=>t.state.toolboxImageListModule.toolboxImageList),(e=>{i.value=e}),{immediate:!0,deep:!0}),(e,t)=>{const g=ws,p=tl,h=Yi,f=U;return y(),x("div",ks,[i.value.length?(y(),x("div",Is,[(y(!0),x(q,null,J(i.value,(e=>(y(),w(g,{"img-obj":e,key:e.uuid,onRemove:m},null,8,["img-obj"])))),128))])):F("",!0),S("div",{class:K(["compress-tool-right",{"no-img":!i.value.length}])},[L(p,{ref_key:"gettingImagesRef",ref:a,onGetImgList:r},null,512),L(h,{ref_key:"compressConfigBoxRef",ref:l,style:{"margin-top":"18rem"},onEncoder:t[0]||(t[0]=e=>{return t=e,o.value=!1,void(n.value=t);var t})},null,512),S("div",{class:K(["user-operate",{compressed:o.value&&i.value.length>1}])},[o.value&&i.value.length>1?(y(),w(f,{key:0,plain:"",type:"success",onClick:u},{default:D((()=>[X(W(e.$t("toolbox.batch_download")),1)])),_:1})):F("",!0),S("div",null,[i.value.length?(y(),w(f,{key:0,plain:"",type:"warning",onClick:c},{default:D((()=>[X(W(e.$t("reset")),1)])),_:1})):F("",!0),i.value.length?(y(),w(f,{key:1,disabled:s.value||o.value,plain:"",type:"primary",onClick:d},{default:D((()=>[X(W(e.$t("toolbox.compress")),1)])),_:1},8,["disabled"])):F("",!0)])],2)],2)])}}}),[["__scopeId","data-v-2aeeda6e"]]);const Ss={class:"base64-tool-container"},Ts={key:0,class:"base64-tool-left"},$s={class:"user-operate"},Ls=v({__name:"base64-tool",setup(e){const t=ca(),a=O(null),l=O([]),i=e=>{e.forEach((e=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:e.uuid,originalName:e.file.name,originalSize:e.file.size,originalBase64:e.base64})}))},n=()=>{var e;t.dispatch("TOOLBOX_IMG_LIST_RESET"),null==(e=a.value)||e.reset()},s=e=>{var l;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",e),null==(l=a.value)||l.remove(e)};return E((()=>t.state.toolboxImageListModule.toolboxImageList),(e=>{l.value=e}),{immediate:!0,deep:!0}),(e,t)=>{const o=ws,r=tl,c=U;return y(),x("div",Ss,[l.value.length?(y(),x("div",Ts,[(y(!0),x(q,null,J(l.value,(e=>(y(),w(o,{"card-type":"base64","img-obj":e,key:e.uuid,onRemove:s},null,8,["img-obj"])))),128))])):F("",!0),S("div",{class:K(["base64-tool-right",{"no-img":!l.value.length}])},[L(r,{ref_key:"gettingImagesRef",ref:a,onGetImgList:i},null,512),S("div",$s,[l.value.length?(y(),w(c,{key:0,plain:"",type:"warning",onClick:n},{default:D((()=>[X(W(e.$t("reset")),1)])),_:1})):F("",!0)])],2)])}}});const Ds={class:"watermark-tool-container"},Cs={key:0,class:"watermark-tool-left"};const Os=[{path:"/",name:"index",redirect:{name:"upload"}},{path:"/config",name:"config",component:Na,meta:{title:"nav.config"}},{path:"/upload",name:"upload",component:ql,meta:{title:"nav.upload"}},{path:"/management",name:"Management",component:Gi,meta:{title:"nav.management"}},{path:"/settings",name:"settings",component:Nn,meta:{title:"nav.settings"}},{path:"/toolbox",name:"Toolbox",component:is,meta:{title:"nav.toolbox"},children:[{path:"/toolbox/compress",name:"Compress",component:xs},{path:"/toolbox/base64",name:"Base64",component:Ia(Ls,[["__scopeId","data-v-06278c2e"]])},{path:"/toolbox/watermark",name:"Watermark",component:Ia(v({__name:"watermark-tool",setup(e){const t=ca(),a=te({enable:!0,text:"",fontSize:0,opacity:0,position:pt.rightBottom,textColor:""}),l=O(null),i=O([]),n=O(!1),s=O(!1),o=e=>{s.value=!1,n.value=!1,e.forEach((e=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:e.uuid,originalName:e.file.name,originalSize:e.file.size,originalBase64:e.base64,originalFile:e.file})}))},r=e=>{a.text=e.text,a.textColor=e.textColor,a.opacity=e.opacity,a.position=e.position,a.fontSize=e.fontSize,s.value=!1},c=()=>{var e;t.dispatch("TOOLBOX_IMG_LIST_RESET"),s.value=!1,null==(e=l.value)||e.reset()},d=async()=>{n.value=!0;for(const e of i.value)e.processing=!0,e.finialFile=await Nt(e.originalFile,a),e.finialBase64=await Mt(e.finialFile)||"",e.finialSize=e.finialFile.size,e.finialName=e.finialFile.name,e.processing=!1;s.value=!0,n.value=!1},u=()=>{i.value.forEach((e=>{Pt(e.finialFile)}))},m=e=>{var a;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",e),null==(a=l.value)||a.remove(e)};return E((()=>t.state.toolboxImageListModule.toolboxImageList),(e=>{i.value=e}),{immediate:!0,deep:!0}),(e,t)=>{const g=ws,p=tl,h=Qi,f=U;return y(),x("div",Ds,[i.value.length?(y(),x("div",Cs,[(y(!0),x(q,null,J(i.value,(e=>(y(),w(g,{"img-obj":e,key:e.uuid,"card-type":"watermark",onRemove:m},null,8,["img-obj"])))),128))])):F("",!0),S("div",{class:K(["watermark-tool-right",{"no-img":!i.value.length}])},[L(p,{ref_key:"gettingImagesRef",ref:l,onGetImgList:o},null,512),L(h,{isTool:!0,onWatermarkConfig:r,style:{"margin-top":"18rem"}}),S("div",{class:K(["user-operate",{watermarked:s.value&&i.value.length>1}])},[s.value&&i.value.length>1?(y(),w(f,{key:0,plain:"",type:"success",onClick:u},{default:D((()=>[X(W(e.$t("toolbox.batch_download")),1)])),_:1})):F("",!0),S("div",null,[i.value.length?(y(),w(f,{key:0,plain:"",type:"warning",onClick:c},{default:D((()=>[X(W(e.$t("reset")),1)])),_:1})):F("",!0),i.value.length?(y(),w(f,{key:1,disabled:n.value||s.value||!a.text,plain:"",type:"primary",onClick:d},{default:D((()=>[X(W(e.$t("toolbox.add_watermark")),1)])),_:1},8,["disabled"])):F("",!0)])],2)],2)])}}}),[["__scopeId","data-v-4743e614"]])}]},{path:"/feedback",name:"feedback",component:ps,meta:{title:"nav.feedback"}},{path:"/:catchAll(.*)",redirect:"/"}],Es=Oe({history:Ee(),routes:Os});Es.beforeEach(((e,t,a)=>{e.meta.title&&Et(e.meta.title),a()}));const Rs=()=>{const e=ca(),t=async e=>{await Re((()=>{const t=document.getElementsByTagName("html")[0];e===ft.dark&&(t.classList.remove("light"),t.classList.add("dark")),e===ft.light&&(t.classList.remove("dark"),t.classList.add("light"))}))},a=async e=>{e===ft.system?await t(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ft.dark:ft.light):await t(e)};E((()=>e.getters.getUserSettings.theme.mode),(async e=>{await a(e)}),{deep:!0,immediate:!0})},Ns={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},As=[S("path",{fill:"currentColor",d:"M288 320a224 224 0 1 0 448 0a224 224 0 1 0-448 0m544 608H160a32 32 0 0 1-32-32v-96a160 160 0 0 1 160-160h448a160 160 0 0 1 160 160v96a32 32 0 0 1-32 32z"},null,-1)];var Us={name:"ep-user-filled",render:function(e,t){return y(),x("svg",Ns,[...As])}};const Ms={id:"busuanzi_value_site_uv",class:"uv"},Ps={id:"busuanzi_value_site_pv",class:"pv"},js=v({__name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(e){const t=e,a=O(null),l=O(!1),i=_((()=>!0));return R((()=>{const e=document.createElement("script");e.async=!0,e.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",a.value.appendChild(e),e.onload=()=>{const e=setTimeout((()=>{var i,n;i=a.value,n=t.isuv,i.querySelector(`.${n?"u":"p"}v`).innerText&&(l.value=!0),clearTimeout(e)}),1500)}})),(t,n)=>V((y(),x("span",{class:"site-count",ref_key:"siteCountDom",ref:a},[V(S("span",Ms,null,512),[[ue,e.isuv]]),V(S("span",Ps,null,512),[[ue,!e.isuv]]),X("+ "+W(t.$t("header.usage_count")),1)],512)),[[ue,l.value&&i.value]])}});const zs=e=>(Z("data-v-4ffb3570"),e=e(),ee(),e),Gs={class:"header"},Bs={class:"header-left"},Vs=[zs((()=>S("div",{class:"logo"},[S("img",{src:"./assets/logo.ffee4291.png",alt:"PicX"})],-1))),zs((()=>S("div",{class:"title"},"PicX",-1)))],Fs={class:"website-count"},Hs={class:"header-right"},Xs={class:"user-info"},Ws={class:"avatar-box"},qs={class:"avatar flex-center"},Js=["src","alt"],Ks={class:"personal-center-popover"},Ys={class:"content-item"},Qs={class:"flex-center"},Zs={class:"content-item"},eo={class:"flex-center"};var to=Ia(v({__name:"header-content",setup(e){const t=ie(),a=ca(),l=_((()=>a.getters.getUserConfigInfo)).value,i=_((()=>a.getters.getUserSettings)).value,n=()=>{a.dispatch("USER_SETTINGS_PERSIST")},s=()=>{a.dispatch("LOGOUT"),t.push("/config"),document.body.click()},o=()=>{l.owner?window.open(`https://github.com/${l.owner}/${l.selectedRepo}`):t.push("/config")};return(e,a)=>{const r=js,c=Us,d=T,u=yl,m=P,g=j,p=he,h=Ne;return y(),x("header",Gs,[S("div",Bs,[S("div",{class:"brand",onClick:a[0]||(a[0]=e=>I(t).push("/"))},Vs),S("div",Fs,[L(r,{isuv:!1})])]),S("div",Hs,[S("div",Xs,[S("div",{class:"username",onClick:o},W(I(l).owner?I(l).owner:e.$t("header.not_login")),1),L(h,{placement:"bottom-end",trigger:"click",width:"220rem","show-arrow":!1,"popper-style":{padding:"0"}},{reference:D((()=>{var e,t,a;return[S("div",Ws,[S("div",qs,[(null==(e=I(l))?void 0:e.avatarUrl)?(y(),x("img",{key:0,src:null==(t=I(l))?void 0:t.avatarUrl,alt:null==(a=I(l))?void 0:a.owner},null,8,Js)):(y(),w(d,{key:1,class:"user-filled-icon"},{default:D((()=>[L(c)])),_:1}))]),L(d,{class:"caret-bottom-icon"},{default:D((()=>[L(u)])),_:1})])]})),default:D((()=>[S("ul",Ks,[S("li",Ys,[S("span",Qs,W(e.$t("header.language")),1),L(g,{size:"small",style:{width:"100rem"},modelValue:I(i).language,"onUpdate:modelValue":a[1]||(a[1]=e=>I(i).language=e),onChange:n},{default:D((()=>[L(m,{label:"中文简体",value:I(_t).zhCN},null,8,["value"]),L(m,{label:"中文繁體",value:I(_t).zhTW},null,8,["value"]),L(m,{label:"English",value:I(_t).en},null,8,["value"])])),_:1},8,["modelValue"])]),L(p,{style:{margin:"5px 0"}}),S("li",Zs,[S("span",eo,W(e.$t("header.theme")),1),L(g,{size:"small",style:{width:"100rem"},modelValue:I(i).theme.mode,"onUpdate:modelValue":a[2]||(a[2]=e=>I(i).theme.mode=e),onChange:n},{default:D((()=>[L(m,{label:e.$t("settings.theme.system"),value:I(ft).system},null,8,["label","value"]),L(m,{label:e.$t("settings.theme.light"),value:I(ft).light},null,8,["label","value"]),L(m,{label:e.$t("settings.theme.dark"),value:I(ft).dark},null,8,["label","value"])])),_:1},8,["modelValue"])]),L(p,{style:{margin:"5px 0"}}),I(l).name||I(l).owner?(y(),x("li",{key:0,class:"content-item",onClick:s},W(e.$t("header.logout")),1)):(y(),x("li",{key:1,class:"content-item",onClick:a[3]||(a[3]=e=>I(t).push("/config"))},W(e.$t("header.login")),1))])])),_:1})])])])}}}),[["__scopeId","data-v-4ffb3570"]]);const ao={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},lo=[S("path",{fill:"currentColor",d:"M389.44 768a96.064 96.064 0 0 1 181.12 0H896v64H570.56a96.064 96.064 0 0 1-181.12 0H128v-64zm192-288a96.064 96.064 0 0 1 181.12 0H896v64H762.56a96.064 96.064 0 0 1-181.12 0H128v-64zm-320-288a96.064 96.064 0 0 1 181.12 0H896v64H442.56a96.064 96.064 0 0 1-181.12 0H128v-64z"},null,-1)];var io={name:"ep-operation",render:function(e,t){return y(),x("svg",ao,[...lo])}};const no={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},so=[S("path",{fill:"currentColor",d:"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640z"},null,-1),S("path",{fill:"currentColor",d:"m469.952 554.24l52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"},null,-1)];var oo={name:"ep-edit",render:function(e,t){return y(),x("svg",no,[...so])}};const ro={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},co=[S("path",{fill:"currentColor",d:"M160 160v704h704V160zm-32-64h768a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H128a32 32 0 0 1-32-32V128a32 32 0 0 1 32-32"},null,-1),S("path",{fill:"currentColor",d:"M384 288q64 0 64 64t-64 64q-64 0-64-64t64-64M185.408 876.992l-50.816-38.912L350.72 556.032a96 96 0 0 1 134.592-17.856l1.856 1.472l122.88 99.136a32 32 0 0 0 44.992-4.864l216-269.888l49.92 39.936l-215.808 269.824l-.256.32a96 96 0 0 1-135.04 14.464l-122.88-99.072l-.64-.512a32 32 0 0 0-44.8 5.952z"},null,-1)];var uo={name:"ep-picture",render:function(e,t){return y(),x("svg",ro,[...co])}};const mo={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},go=[S("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088l-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36l-116.224-25.088l-65.28 113.152l79.68 88.192l-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136l-79.808 88.192l65.344 113.152l116.224-25.024l22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152l24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296l116.288 25.024l65.28-113.152l-79.744-88.192l1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136l79.808-88.128l-65.344-113.152l-116.288 24.96l-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384a192 192 0 0 1 0-384m0 64a128 128 0 1 0 0 256a128 128 0 0 0 0-256"},null,-1)];var po={name:"ep-setting",render:function(e,t){return y(),x("svg",mo,[...go])}};const ho={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},fo=[S("path",{fill:"currentColor",d:"M128 384v448h768V384zm-32-64h832a32 32 0 0 1 32 32v512a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V352a32 32 0 0 1 32-32m64-128h704v64H160zm96-128h512v64H256z"},null,-1)];var vo={name:"ep-files",render:function(e,t){return y(),x("svg",ho,[...fo])}};const _o={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},bo=[S("path",{fill:"currentColor",d:"m174.72 855.68l135.296-45.12l23.68 11.84C388.096 849.536 448.576 864 512 864c211.84 0 384-166.784 384-352S723.84 160 512 160S128 326.784 128 512c0 69.12 24.96 139.264 70.848 199.232l22.08 28.8l-46.272 115.584zm-45.248 82.56A32 32 0 0 1 89.6 896l58.368-145.92C94.72 680.32 64 596.864 64 512C64 299.904 256 96 512 96s448 203.904 448 416s-192 416-448 416a461.056 461.056 0 0 1-206.912-48.384l-175.616 58.56z"},null,-1),S("path",{fill:"currentColor",d:"M512 563.2a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4m192 0a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4m-384 0a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4"},null,-1)];var yo={name:"ep-chat-dot-round",render:function(e,t){return y(),x("svg",_o,[...bo])}};const wo=we([{uuid:$t(),name:"nav.config",icon:oo,isActive:!1,path:"/config",isShow:!0},{uuid:$t(),name:"nav.upload",icon:ul,isActive:!1,path:"/upload",isShow:!0},{uuid:$t(),name:"nav.management",icon:uo,isActive:!1,path:"/management",isShow:!0},{uuid:$t(),name:"nav.settings",icon:po,isActive:!1,path:"/settings",isShow:!0},{uuid:$t(),name:"nav.toolbox",icon:vo,isActive:!1,path:"/toolbox",isShow:!0},{uuid:$t(),name:"nav.feedback",icon:yo,isActive:!1,path:"/feedback",isShow:!0}]);const ko={class:"nav"},Io={class:"nav-list"},xo=["onClick"],So={class:"nav-content"},To={class:"nav-name"},$o={class:"nav-item quick-actions flex-center"},Lo={class:"nav-content"},Do={class:"nav-name"},Co={class:"quick-actions-popover"};var Oo=Ia(v({__name:"nav-content",setup(e){const t=ie(),a=ca(),l=_((()=>a.getters.getUserConfigInfo)).value,i=_((()=>a.getters.getUserSettings)).value,n=_((()=>{switch(i.elementPlusSize){case mt.small:return 22;case mt.large:return 30;default:return 26}})),s=e=>{wo.value.forEach((t=>{const a=t;return a.isActive=t.path===e||e.includes(t.path),a})),Ae(wo)},r=()=>{a.dispatch("USER_SETTINGS_PERSIST")};return E((()=>t.currentRoute.value),(e=>{s(e.path)})),E((()=>l.logined),(e=>{wo.value.forEach((t=>{switch(t.path){case"/management":case"/settings":t.isShow=e}}))}),{deep:!0,immediate:!0}),R((()=>{t.isReady().then((()=>{s(t.currentRoute.value.path)}))})),(e,a)=>{const s=T,c=io,d=ke,u=Ne;return y(),x("aside",ko,[S("ul",Io,[(y(!0),x(q,null,J(I(wo),((a,i)=>V((y(),x("li",{class:K(["nav-item flex-center",{active:a.isActive}]),key:i+a.uuid,onClick:e=>(e=>{const{path:a}=e;if("/management"===a){if(""===l.selectedRepo)return o.warning("请选择一个仓库"),void t.push("/config");if(""===l.selectedDir)return o.warning("目录不能为空"),void t.push("/config")}t.push(a)})(a)},[S("div",So,[L(s,{size:n.value},{default:D((()=>[(y(),w(Le(a.icon)))])),_:2},1032,["size"]),S("span",To,W(e.$t(a.name)),1)])],10,xo)),[[ue,a.isShow]]))),128))]),S("div",$o,[L(u,{placement:"right-end",width:"en"===I(i).language?"230rem":"190rem",trigger:"click","show-arrow":!1,"popper-style":{padding:"0"}},{reference:D((()=>[S("div",Lo,[L(s,{size:n.value},{default:D((()=>[L(c)])),_:1},8,["size"]),S("span",Do,W(e.$t("nav.actions")),1)])])),default:D((()=>[S("div",Co,[L(d,{modelValue:I(i).watermark.enable,"onUpdate:modelValue":a[0]||(a[0]=e=>I(i).watermark.enable=e),class:"mb-2","active-text":e.$t("actions.watermark"),onChange:r},null,8,["modelValue","active-text"]),L(d,{modelValue:I(i).compress.enable,"onUpdate:modelValue":a[1]||(a[1]=e=>I(i).compress.enable=e),class:"mb-2","active-text":e.$t("actions.compress"),onChange:r},null,8,["modelValue","active-text"]),L(d,{modelValue:I(i).imageLinkFormat.enable,"onUpdate:modelValue":a[2]||(a[2]=e=>I(i).imageLinkFormat.enable=e),class:"mb-2","active-text":e.$t("actions.transform")+I(i).imageLinkFormat.selected,onChange:r},null,8,["modelValue","active-text"])])])),_:1},8,["width"])])])}}}),[["__scopeId","data-v-74328584"]]);const Eo={class:"main-container"},Ro={class:"top-container"},No={class:"bottom-container"},Ao={class:"bottom-content"},Uo={class:"left"},Mo={class:"right"};var Po=Ia(v({__name:"main-container",setup:e=>(R((()=>{Rs()})),(e,t)=>{const a=$e("router-view");return y(),x("main",Eo,[S("div",Ro,[L(to)]),S("div",No,[S("div",Ao,[S("div",Uo,[L(Oo)]),S("div",Mo,[L(a)])])])])})}),[["__scopeId","data-v-38c596be"]]);const jo=v({__name:"App",setup(e){const t=C(),a=ca(),l=_((()=>a.getters.getUserSettings)).value,i=O(mt.default),n=O(Me),r=e=>{e<=600?(null==a||a.dispatch("SET_USER_SETTINGS",{elementPlusSize:mt.small}),i.value=mt.small):e<=900?(null==a||a.dispatch("SET_USER_SETTINGS",{elementPlusSize:mt.default}),i.value=mt.default):(null==a||a.dispatch("SET_USER_SETTINGS",{elementPlusSize:mt.large}),i.value=mt.large)},c=e=>{e===_t.zhCN?(n.value=Me,t.proxy.$i18n.locale="zh-CN"):e===_t.zhTW?(n.value=Pe,t.proxy.$i18n.locale="zh-TW"):e===_t.en?(n.value=je,t.proxy.$i18n.locale="en"):(n.value=Me,t.proxy.$i18n.locale="zh-CN"),Et(Es.currentRoute.value.meta.title)},d=()=>{c(l.language),(async()=>{try{const e=await s.get("https://api.ipify.org?format=json"),t=await s.get(`https://ipapi.co/${e.data.ip}/country/`);return Promise.resolve(t.data)}catch(e){return Promise.resolve("CN")}})().then((e=>{var i,n,s,r,d,u,m;const g=(e=>"CN"===e?_t.zhCN:"HK"===e||"TW"===e||"MO"===e?_t.zhTW:_t.en)(e);if(g!==l.language){const l=null==(i=null==t?void 0:t.proxy)?void 0:i.$t("confirm",g),p=null==(n=null==t?void 0:t.proxy)?void 0:n.$t("cancel",g),h=null==(d=null==t?void 0:t.proxy)?void 0:d.$t("toggle_language_msg",g,{region:null==(s=null==t?void 0:t.proxy)?void 0:s.$t(`region.${e}`,g),language:null==(r=null==t?void 0:t.proxy)?void 0:r.$t(`language.${g}`,g)}),f=o({customClass:"toggle-language-message",duration:0,offset:20,message:`<div class="content-box">\n                    <span class="msg">${h}</span>\n                    <spna class="btn-box">\n                      <span class="confirm btn">${l}</span>\n                      <span class="cancel btn">${p}</span>\n                    </spna>\n                  </div>`,dangerouslyUseHTMLString:!0});null==(u=document.querySelector(".toggle-language-message .content-box .confirm"))||u.addEventListener("click",(()=>{c(g),a.dispatch("SET_USER_SETTINGS",{language:g}),f.close()})),null==(m=document.querySelector(".toggle-language-message .content-box .cancel"))||m.addEventListener("click",(()=>{f.close()}))}}))},u=()=>{r(window.innerWidth),window.addEventListener("resize",((e,t=500)=>{let a,l;return function(...i){l=i,a||(a=setTimeout((()=>{e(...l),a=void 0}),t))}})((e=>{r(e.target.innerWidth)}),600)),Rs(),d()};return E((()=>l.language),(e=>{c(e)})),R((()=>{u()})),(e,t)=>(y(),w(I(Ue),{size:i.value,"z-index":3e3,locale:n.value},{default:D((()=>[L(Po)])),_:1},8,["size","locale"]))}});const zo="custom-contextmenu-container";let Go=null,Bo=!1;const Vo={mounted(e,t){e.addEventListener("contextmenu",(e=>{const{dir:a,type:l,img:i}=t.value;e.preventDefault(),e.stopPropagation();const n=_((()=>oa.getters.getUserViewDir)).value,s=a?`${"/"===n?"":`${n}/`}${a}`:n;Go=document.querySelector(`.${zo}`),Go||(Go=document.createElement("ul"),Go.setAttribute("class",zo),Go.style.position="fixed",Go.style.zIndex="1000",Go.innerHTML=`<li class="custom-contextmenu-item upload-image"></li><li class="custom-contextmenu-item copy-link">${St.global.t("copy_link")}</li>`,document.body.appendChild(Go));const o=null==Go?void 0:Go.querySelector(".upload-image"),r=null==Go?void 0:Go.querySelector(".copy-link");l===yt.img?(r.style.display="block",o.innerHTML=St.global.t("management.contextmenu_1")):(r.style.display="none",o.innerHTML=St.global.t("management.contextmenu_2",{dir:"/"===s?St.global.t("management.contextmenu_3"):s}));let c=e.clientX,d=e.clientY;const u=Go.clientWidth,m=Go.clientHeight,g=document.documentElement.clientWidth,p=document.documentElement.clientHeight;u+c>g&&(c=g-u-6),m+d>p&&(d=p-m-6),Go.style.top=`${d}px`,Go.style.left=`${c}px`,Bo||(Bo=!0,null==o||o.addEventListener("click",(async()=>{const e="/"===s?dt.rootDir:dt.repoDir,t="/"===s?[]:s.split("/");await oa.dispatch("SET_USER_CONFIG_INFO",{dirMode:e,selectedDir:s,selectedDirList:t}),await Es.push("/upload")})),null==r||r.addEventListener("click",(async()=>{const e=_((()=>oa.getters.getUserConfigInfo)).value,t=_((()=>oa.getters.getUserSettings)).value;qt(i,e,t)})));const h=()=>{Go&&(document.removeEventListener("click",h),document.body.removeChild(Go),Go=null,Bo=!1)};document.addEventListener("click",h)}))}},Fo=ze(jo);Fo.directive("contextmenu",Vo),Fo.use(Es).use(oa,ra).use(St).mount("#app");
